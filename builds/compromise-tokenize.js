!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).nlp=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");var h=function(t){for(var e=(t=t||"_")+"-",n=0;n<7;n++)e+=c[Math.floor(Math.random()*c.length)];return e},l={"!":"¡","?":"¿Ɂ",'"':'“”"❝❞',"'":"‘‛❛❜","-":"—–",a:"ªÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧȺΆΑΔΛάαλАадѦѧӐӑӒӓƛɅæ",b:"ßþƀƁƂƃƄƅɃΒβϐϦБВЪЬвъьѢѣҌҍ",c:"¢©ÇçĆćĈĉĊċČčƆƇƈȻȼͻͼͽϲϹϽϾСсєҀҁҪҫ",d:"ÐĎďĐđƉƊȡƋƌǷ",e:"ÈÉÊËèéêëĒēĔĕĖėĘęĚěƎƏƐǝȄȅȆȇȨȩɆɇΈΕΞΣέεξϱϵ϶ЀЁЕЭеѐёҼҽҾҿӖӗӘәӚӛӬӭ",f:"ƑƒϜϝӺӻҒғſ",g:"ĜĝĞğĠġĢģƓǤǥǦǧǴǵ",h:"ĤĥĦħƕǶȞȟΉΗЂЊЋНнђћҢңҤҥҺһӉӊ",I:"ÌÍÎÏ",i:"ìíîïĨĩĪīĬĭĮįİıƖƗȈȉȊȋΊΐΪίιϊІЇії",j:"ĴĵǰȷɈɉϳЈј",k:"ĶķĸƘƙǨǩΚκЌЖКжкќҚқҜҝҞҟҠҡ",l:"ĹĺĻļĽľĿŀŁłƚƪǀǏǐȴȽΙӀӏ",m:"ΜϺϻМмӍӎ",n:"ÑñŃńŅņŇňŉŊŋƝƞǸǹȠȵΝΠήηϞЍИЙЛПийлпѝҊҋӅӆӢӣӤӥπ",o:"ÒÓÔÕÖØðòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱΌΘΟθοσόϕϘϙϬϭϴОФоѲѳӦӧӨөӪӫ",p:"ƤƿΡρϷϸϼРрҎҏÞ",q:"Ɋɋ",r:"ŔŕŖŗŘřƦȐȑȒȓɌɍЃГЯгяѓҐґ",s:"ŚśŜŝŞşŠšƧƨȘșȿЅѕ",t:"ŢţŤťŦŧƫƬƭƮȚțȶȾΓΤτϮТт",u:"µÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưƱƲǓǔǕǖǗǘǙǚǛǜȔȕȖȗɄΰμυϋύ",v:"νѴѵѶѷ",w:"ŴŵƜωώϖϢϣШЩшщѡѿ",x:"×ΧχϗϰХхҲҳӼӽӾӿ",y:"ÝýÿŶŷŸƳƴȲȳɎɏΎΥΫγψϒϓϔЎУучўѰѱҮүҰұӮӯӰӱӲӳ",z:"ŹźŻżŽžƩƵƶȤȥɀΖζ"},f={};Object.keys(l).forEach((function(t){l[t].split("").forEach((function(e){f[e]=t}))}));var p=function(t){var e=t.split("");return e.forEach((function(t,n){f[t]&&(e[n]=f[t])})),e.join("")},d=/([A-Z]\.)+[A-Z]?,?$/,v=/^[A-Z]\.,?$/,m=/[A-Z]{2,}('s|,)?$/,g=/([a-z]\.){2,}[a-z]\.?$/,b=function(t){return!0===d.test(t)||(!0===g.test(t)||(!0===v.test(t)||!0===m.test(t)))},y=/[a-z\u00C0-\u00FF] ?\/ ?[a-z\u00C0-\u00FF]/,A=function(t){var e=t=(t=(t=t||"").toLowerCase()).trim();return t=p(t),!0===y.test(t)&&(t=t.replace(/\/.*/,"")),t=(t=(t=(t=(t=(t=(t=t.replace(/^[#@]/,"")).replace(/[,;.!?]+$/,"")).replace(/[\u0027\u0060\u00B4\u2018\u2019\u201A\u201B\u2032\u2035\u2039\u203A]+/g,"'")).replace(/[\u0022\u00AB\u00BB\u201C\u201D\u201E\u201F\u2033\u2034\u2036\u2037\u2E42\u301D\u301E\u301F\uFF02]+/g,'"')).replace(/\u2026/g,"...")).replace(/\u2013/g,"-")).replace(/([aeiou][ktrp])in$/,"$1ing"),!0===/^(re|un)-?[^aeiou]./.test(t)&&(t=t.replace("-","")),!1===/^[:;]/.test(t)&&(t=(t=(t=t.replace(/\.{3,}$/g,"")).replace(/[",\.!:;\?\)]+$/g,"")).replace(/^['"\(]+/g,"")),""===(t=t.trim())&&(t=e),b(t)&&(t=t.replace(/\./g,"")),t=t.replace(/([0-9]),([0-9])/g,"$1$2")},w=function(t){return t=(t=t.replace(/['’]s$/,"")).replace(/s['’]$/,"s")},x=/^[ \n\t\.’'\[\](){}⟨⟩:,،、‒–—―…!.‹›«»‐\-?‘’;\/⁄·&*•^†‡°¡¿※№÷×ºª%‰+−=‱¶′″‴§~|‖¦©℗®℠™¤₳฿\u0022|\uFF02|\u0027|\u201C|\u2018|\u201F|\u201B|\u201E|\u2E42|\u201A|\u00AB|\u2039|\u2035|\u2036|\u2037|\u301D|\u0060|\u301F]+/,P=/[ \n\t\.’'\[\](){}⟨⟩:,،、‒–—―…!.‹›«»‐\-?‘’;\/⁄·&*@•^†‡°¡¿※#№÷×ºª‰+−=‱¶′″‴§~|‖¦©℗®℠™¤₳฿\u0022|\uFF02|\u0027|\u201D|\u2019|\u201D|\u2019|\u201D|\u201D|\u2019|\u00BB|\u203A|\u2032|\u2033|\u2034|\u301E|\u00B4|\u301E]+$/,j=/\//,E=/['’]/,O=/^[a-z]\.([a-z]\.)+/i,C=/^[-+\.][0-9]/,k=function(t){var e=t,n="",r="";""===(t=(t=t.replace(x,(function(e){return"-"!==(n=e)&&"+"!==n&&"."!==n||!C.test(t)?"":(n="",e)}))).replace(P,(function(i){return r=i,E.test(i)&&/[sn]['’]$/.test(e)&&!1===E.test(n)?(r=r.replace(E,""),"'"):!0===O.test(t)?(r=r.replace(/\./,""),"."):""})))&&(e=e.replace(/ *$/,(function(t){return r=t||"",""})),t=e,n="",r=r);var i=A(t),o={text:t,clean:i,reduced:w(i),pre:n,post:r};return j.test(t)&&t.split(j).forEach((function(t){o.alias=o.alias||{},o.alias[t.trim()]=!0})),o};function F(t,e){return t(e={exports:{}},e.exports),e.exports}var T=F((function(t,e){var n=/^[A-Z][a-z'\u00C0-\u00FF]/,r=/^[A-Z]+s?$/;e.toUpperCase=function(){return this.text=this.text.toUpperCase(),this},e.toLowerCase=function(){return this.text=this.text.toLowerCase(),this},e.toTitleCase=function(){return this.text=this.text.replace(/^ *[a-z\u00C0-\u00FF]/,(function(t){return t.toUpperCase()})),this},e.isUpperCase=function(){return r.test(this.text)},e.isTitleCase=function(){return n.test(this.text)},e.titleCase=e.isTitleCase})),N=(T.toUpperCase,T.toLowerCase,T.toTitleCase,T.isUpperCase,T.isTitleCase,T.titleCase,F((function(t,e){var n=/(\u0022|\uFF02|\u0027|\u201C|\u2018|\u201F|\u201B|\u201E|\u2E42|\u201A|\u00AB|\u2039|\u2035|\u2036|\u2037|\u301D|\u0060|\u301F)/,r=/(\u0022|\uFF02|\u0027|\u201D|\u2019|\u201D|\u2019|\u201D|\u201D|\u2019|\u00BB|\u203A|\u2032|\u2033|\u2034|\u301E|\u00B4|\u301E)/;e.hasPost=function(t){return-1!==this.post.indexOf(t)},e.hasPre=function(t){return-1!==this.pre.indexOf(t)},e.hasQuote=function(){return n.test(this.pre)||r.test(this.post)},e.hasQuotation=e.hasQuote,e.hasComma=function(){return this.hasPost(",")},e.hasPeriod=function(){return!0===this.hasPost(".")&&!1===this.hasPost("...")},e.hasExclamation=function(){return this.hasPost("!")},e.hasQuestionMark=function(){return this.hasPost("?")||this.hasPost("¿")},e.hasEllipses=function(){return this.hasPost("..")||this.hasPost("…")||this.hasPre("..")||this.hasPre("…")},e.hasSemicolon=function(){return this.hasPost(";")},e.hasSlash=function(){return/\//.test(this.text)},e.hasHyphen=function(){var t=/(-|–|—)/;return t.test(this.post)||t.test(this.pre)},e.hasDash=function(){var t=/ (-|–|—) /;return t.test(this.post)||t.test(this.pre)},e.hasContraction=function(){return Boolean(this.implicit)},e.addPunctuation=function(t){return","!==t&&";"!==t||(this.post=this.post.replace(t,"")),this.post=t+this.post,this}}))),V=(N.hasPost,N.hasPre,N.hasQuote,N.hasQuotation,N.hasComma,N.hasPeriod,N.hasExclamation,N.hasQuestionMark,N.hasEllipses,N.hasSemicolon,N.hasSlash,N.hasHyphen,N.hasDash,N.hasContraction,N.addPunctuation,function(){}),$=function(t,e,n,r){return e.id===t.id||(!0===e.anything||(!0!==e.start||0===n)&&((!0!==e.end||n===r-1)&&(void 0!==e.word?null!==t.implicit&&t.implicit===e.word||(!(void 0===t.alias||!t.alias.hasOwnProperty(e.word))||(!0===e.soft&&e.word===t.root||(e.word===t.clean||e.word===t.text||e.word===t.reduced))):void 0!==e.tag?!0===t.tags[e.tag]:void 0!==e.method?"function"==typeof t[e.method]&&!0===t[e.method]():void 0!==e.regex?e.regex.test(t.clean):void 0!==e.oneOf?e.oneOf.hasOwnProperty(t.reduced)||e.oneOf.hasOwnProperty(t.text):void 0!==e.choices&&("and"===e.operator?e.choices.every((function(e){return V(t,e,n,r)})):e.choices.some((function(e){return V(t,e,n,r)}))))))},S=V=function(t,e,n,r){var i=$(t,e,n,r);return!0===e.negative?!i:i},B={},I={doesMatch:function(t,e,n){return S(this,t,e,n)},isAcronym:function(){return b(this.text)},isImplicit:function(){return""===this.text&&Boolean(this.implicit)},isKnown:function(){return Object.keys(this.tags).some((function(t){return!0!==B[t]}))},setRoot:function(t){var e=t.transforms,n=this.implicit||this.clean;if(this.tags.Plural&&(n=e.toSingular(n,t)),this.tags.Verb&&!this.tags.Negative&&!this.tags.Infinitive){var r=null;this.tags.PastTense?r="PastTense":this.tags.Gerund?r="Gerund":this.tags.PresentTense?r="PresentTense":this.tags.Participle?r="Participle":this.tags.Actor&&(r="Actor"),n=e.toInfinitive(n,t,r)}this.root=n}},D=/[\s-]/,q=/^[A-Z-]+$/,L={textOut:function(t,e,n){t=t||{};var r=this.text,i=this.pre,o=this.post;return!0===t.reduced&&(r=this.reduced||""),!0===t.root&&(r=this.root||""),!0===t.implicit&&this.implicit&&(r=this.implicit||""),!0===t.normal&&(r=this.clean||this.text||""),!0===t.root&&(r=this.root||this.reduced||""),!0===t.unicode&&(r=p(r)),!0===t.titlecase&&(this.tags.ProperNoun&&!this.titleCase()||(this.tags.Acronym?r=r.toUpperCase():q.test(r)&&!this.tags.Acronym&&(r=r.toLowerCase()))),!0===t.lowercase&&(r=r.toLowerCase()),!0===t.acronyms&&this.tags.Acronym&&(r=r.replace(/\./g,"")),!0!==t.whitespace&&!0!==t.root||(i="",o=" ",!1!==D.test(this.post)&&!t.last||this.implicit||(o="")),!0!==t.punctuation||t.root||(!0===this.hasPost(".")?o="."+o:!0===this.hasPost("?")?o="?"+o:!0===this.hasPost("!")?o="!"+o:!0===this.hasPost(",")?o=","+o:!0===this.hasEllipses()&&(o="..."+o)),!0!==e&&(i=""),!0!==n&&(o=""),!0===t.abbreviations&&this.tags.Abbreviation&&(o=o.replace(/^\./,"")),i+r+o}},M={Auxiliary:1,Possessive:1},z=function(t,e){var n=Object.keys(t.tags),r=e.tags;return n=n.sort((function(t,e){return M[e]||!r[e]?-1:r[e]?r[t]?r[t].lineage.length>r[e].lineage.length?1:r[t].isA.length>r[e].isA.length?-1:0:0:1}))},W={text:!0,tags:!0,implicit:!0,whitespace:!0,clean:!1,id:!1,index:!1,offset:!1,bestTag:!1},U={json:function(t,e){t=t||{};var n={};return(t=Object.assign({},W,t)).text&&(n.text=this.text),t.normal&&(n.normal=this.normal),t.tags&&(n.tags=Object.keys(this.tags)),t.clean&&(n.clean=this.clean),(t.id||t.offset)&&(n.id=this.id),t.implicit&&null!==this.implicit&&(n.implicit=this.implicit),t.whitespace&&(n.pre=this.pre,n.post=this.post),t.bestTag&&(n.bestTag=z(this,e)[0]),n}},_=Object.assign({},T,N,I,L,U);function H(){return"undefined"!=typeof window&&window.document}var G=function(t,e){for(t=t.toString();t.length<e;)t+=" ";return t},Q=function(t,e,n){if(H())console.log("%c"+G(t.clean,3)+"  + "+e+" ","color: #6accb2;");else{var r="[33m"+G(t.clean,15)+"[0m + [32m"+e+"[0m ";n&&(r=G(r,35)+" "+n),console.log(r)}},R=function(t,e,n){if(H())console.log("%c"+G(t.clean,3)+"  - "+e+" ","color: #AB5850;");else{var r="[33m"+G(t.clean,3)+" [31m - #"+e+"[0m ";n&&(r=G(r,35)+" "+n),console.log(r)}},Z=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},J=function(t,e,n,r){var i=r.tags;if(""!==e&&"."!==e&&"-"!==e&&("#"===e[0]&&(e=e.replace(/^#/,"")),e=Z(e),!0!==t.tags[e])){var o=r.isVerbose();!0===o&&Q(t,e,n),t.tags[e]=!0,!0===i.hasOwnProperty(e)&&(i[e].isA.forEach((function(e){t.tags[e]=!0,!0===o&&Q(t,"→ "+e)})),t.unTag(i[e].notA,"←",r))}},Y=function(t,e,n,r){if("string"!=typeof e)for(var i=0;i<e.length;i++)J(t,e[i],n,r);else J(t,e,n,r)},K=/^[a-z]/,X=function(t,e,n,r){var i,o=r.isVerbose();if("*"===e)return t.tags={},t;e=e.replace(/^#/,""),!0===K.test(e)&&(e=(i=e).charAt(0).toUpperCase()+i.substr(1)),!0===t.tags[e]&&(delete t.tags[e],!0===o&&R(t,e,n));var s=r.tags;if(s[e])for(var a=s[e].lineage,u=0;u<a.length;u++)!0===t.tags[a[u]]&&(delete t.tags[a[u]],!0===o&&R(t," - "+a[u]));return t},tt=function(t,e,n,r){if("string"!=typeof e&&e)for(var i=0;i<e.length;i++)X(t,e[i],n,r);else X(t,e,n,r)},et=function t(e,n,r){var i=r.tags;if("#"===n[0]&&(n=n.replace(/^#/,"")),void 0===i[n])return!0;for(var o=i[n].notA||[],s=0;s<o.length;s++)if(!0===e.tags[o[s]])return!1;return void 0===i[n].isA||t(e,i[n].isA,r)},nt={tag:function(t,e,n){return Y(this,t,e,n),this},tagSafe:function(t,e,n){return et(this,t,n)&&Y(this,t,e,n),this},unTag:function(t,e,n){return tt(this,t,e,n),this},canBe:function(t,e){return et(this,t,e)}},rt=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e(this,t),n=String(n);var r=k(n);this.text=r.text||"",this.clean=r.clean,this.reduced=r.reduced,this.root=null,this.implicit=null,this.pre=r.pre||"",this.post=r.post||"",this.tags={},this.prev=null,this.next=null,this.id=h(r.clean),this.isA="Term",r.alias&&(this.alias=r.alias)}return r(t,[{key:"set",value:function(t){var e=k(t);return this.text=e.text,this.clean=e.clean,this}}]),t}();rt.prototype.clone=function(){var t=new rt(this.text);return t.pre=this.pre,t.post=this.post,t.tags=Object.assign({},this.tags),t},Object.assign(rt.prototype,_),Object.assign(rt.prototype,nt);var it=rt,ot={terms:function(t){if(0===this.length)return[];if(this.cache.terms)return void 0!==t?this.cache.terms[t]:this.cache.terms;for(var e=[this.pool.get(this.start)],n=0;n<this.length-1;n+=1){var r=e[e.length-1].next;if(null===r){console.error("Compromise error: Linked list broken in phrase '"+this.start+"'");break}var i=this.pool.get(r);if(e.push(i),void 0!==t&&t===n)return e[t]}return void 0===t&&(this.cache.terms=e),void 0!==t?e[t]:e},clone:function(t){var e=this;if(t){var n=this.buildFrom(this.start,this.length);return n.cache=this.cache,n}var r=this.terms().map((function(t){return t.clone()}));return r.forEach((function(t,n){e.pool.add(t),r[n+1]&&(t.next=r[n+1].id),r[n-1]&&(t.prev=r[n-1].id)})),this.buildFrom(r[0].id,r.length)},lastTerm:function(){var t=this.terms();return t[t.length-1]},hasId:function(t){if(0===this.length||!t)return!1;if(this.start===t)return!0;if(this.cache.terms){for(var e=this.cache.terms,n=0;n<e.length;n++)if(e[n].id===t)return!0;return!1}for(var r=this.start,i=0;i<this.length-1;i+=1){var o=this.pool.get(r);if(void 0===o)return console.error("Compromise error: Linked list broken. Missing term '".concat(r,"' in phrase '").concat(this.start,"'\n")),!1;if(o.next===t)return!0;r=o.next}return!1},wordCount:function(){return this.terms().filter((function(t){return""!==t.text})).length},fullSentence:function(){for(var t=this.terms(0);t.prev;)t=this.pool.get(t.prev);for(var e=t.id,n=1;t.next;)t=this.pool.get(t.next),n+=1;return this.buildFrom(e,n)}},st=function(t){return t.replace(/ +$/,"")},at={text:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;"string"==typeof t&&(t="normal"===t?{whitespace:!0,unicode:!0,lowercase:!0,punctuation:!0,acronyms:!0,abbreviations:!0,implicit:!0,normal:!0}:"clean"===t?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0}:"reduced"===t?{titlecase:!1,lowercase:!0,punctuation:!1,whitespace:!0,unicode:!0,implicit:!0,reduced:!0}:"root"===t?{titlecase:!1,lowercase:!0,punctuation:!0,whitespace:!0,unicode:!0,implicit:!0,root:!0}:{});var r=this.terms(),i=!1;r[0]&&null===r[0].prev&&null===r[r.length-1].next&&(i=!0);var o=r.reduce((function(o,s,a){t.last=n&&a===r.length-1;var u=!0,c=!0;return!1===i&&(0===a&&e&&(u=!1),a===r.length-1&&n&&(c=!1)),o+s.textOut(t,u,c)}),"");return!0===i&&n&&(o=st(o)),!0===t.trim&&(o=o.trim()),o}},ut={trim:function(){var t=this.terms();if(t.length>0){t[0].pre=t[0].pre.replace(/^\s+/,"");var e=t[t.length-1];e.post=e.post.replace(/\s+$/,"")}return this}},ct=/[.?!]\s*$/,ht=function(t,e){e[0].pre=t[0].pre;var n,r,i=t[t.length-1],o=e[e.length-1];o.post=(n=i.post,r=o.post,ct.test(r)?r+n.match(/\s*$/):n),i.post="",""===i.post&&(i.post+=" ")},lt=function(t,e,n){var r=t.terms(),i=e.terms();ht(r,i),function(t,e,n){var r=t[t.length-1],i=e[e.length-1],o=r.next;(r.next=e[0].id,i.next=o,o)&&(n.get(o).prev=i.id);var s=t[0].id;s&&(e[0].prev=s)}(r,i,t.pool);var o,s=[t],a=t.start,u=[n];return(u=u.concat(n.parents())).forEach((function(t){var e=t.list.filter((function(t){return t.hasId(a)}));s=s.concat(e)})),(s=(o=s).filter((function(t,e){return o.indexOf(t)===e}))).forEach((function(t){t.length+=e.length})),t.cache={},t},ft=/ /,pt=function(t,e,n){var r=t.start,i=e.terms();!function(t){var e=t[t.length-1];!1===ft.test(e.post)&&(e.post+=" ")}(i),function(t,e,n){var r=n[n.length-1];r.next=t.start;var i=t.pool,o=i.get(t.start);o.prev&&(i.get(o.prev).next=e.start);n[0].prev=t.terms(0).prev,t.terms(0).prev=r.id}(t,e,i);var o,s=[t],a=[n];return(a=a.concat(n.parents())).forEach((function(t){var n=t.list.filter((function(t){return t.hasId(r)||t.hasId(e.start)}));s=s.concat(n)})),(s=(o=s).filter((function(t,e){return o.indexOf(t)===e}))).forEach((function(t){t.length+=e.length,t.start===r&&(t.start=e.start),t.cache={}})),t},dt=function(t,e){var n=e.pool(),r=t.terms(),i=n.get(r[0].prev)||{},o=n.get(r[r.length-1].next)||{};r[0].implicit&&i.implicit&&(i.set(i.implicit),i.post+=" "),function(t,e,n,r){var i=t.parents();i.push(t),i.forEach((function(t){var i=t.list.find((function(t){return t.hasId(e)}));i&&(i.length-=n,i.start===e&&(i.start=r.id),i.cache={})})),t.list=t.list.filter((function(t){return!(!t.start||!t.length)}))}(e,t.start,t.length,o),i&&(i.next=o.id),o&&(o.prev=i.id)},vt={append:function(t,e){return lt(this,t,e),this},prepend:function(t,e){return pt(this,t,e),this},delete:function(t){return dt(this,t),this},replace:function(t,e){var n=this.length;lt(this,t,e);var r=this.buildFrom(this.start,this.length);r.length=n,dt(r,e)},splitOn:function(t){var e=this.terms(),n={before:null,match:null,after:null},r=e.findIndex((function(e){return e.id===t.start}));if(-1===r)return n;var i=e.slice(0,r);i.length>0&&(n.before=this.buildFrom(i[0].id,i.length));var o=e.slice(r,r+t.length);o.length>0&&(n.match=this.buildFrom(o[0].id,o.length));var s=e.slice(r+t.length,e.length);return s.length>0&&(n.after=this.buildFrom(s[0].id,s.length,this.pool)),n}},mt={json:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n={};return t.text&&(n.text=this.text()),t.normal&&(n.normal=this.text("normal")),t.clean&&(n.clean=this.text("clean")),t.reduced&&(n.reduced=this.text("reduced")),t.root&&(n.root=this.text("root")),t.trim&&(n.text&&(n.text=n.text.trim()),n.normal&&(n.normal=n.normal.trim()),n.reduced&&(n.reduced=n.reduced.trim())),t.terms&&(!0===t.terms&&(t.terms={}),n.terms=this.terms().map((function(n){return n.json(t.terms,e)}))),n}},gt={lookAhead:function(t){t||(t=".*");var e=this.pool,n=[],r=this.terms();return function t(r){var i=e.get(r);i&&(n.push(i),i.prev&&t(i.next))}(r[r.length-1].next),0===n.length?[]:this.buildFrom(n[0].id,n.length).match(t)},lookBehind:function(t){t||(t=".*");var e=this.pool,n=[];return function t(r){var i=e.get(r);i&&(n.push(i),i.prev&&t(i.prev))}(e.get(this.start).prev),0===n.length?[]:this.buildFrom(n[n.length-1].id,n.length).match(t)}},bt=Object.assign({},ot,at,ut,vt,mt,gt),yt=function(t,e){if(0===e.length)return!0;for(var n=0;n<e.length;n+=1){var r=e[n];if(!0!==r.optional&&!0!==r.negative&&!0===r.start&&n>0)return!0;if(!0===r.anything&&!0===r.negative)return!0}return!1},At=function(t,e,n,r,i,o){for(var s=e;e<t.length;e+=1){if(r&&t[e].doesMatch(r,i+e,o))return e;var a=e-s+1;if(void 0!==n.max&&a===n.max)return e;if(!1===t[e].doesMatch(n,i+e,o))return void 0!==n.min&&a<n.min?null:e}return e},wt=function(t,e,n,r,i){if(!n)return t.length;for(;e<t.length;e+=1)if(!0===t[e].doesMatch(n,r+e,i))return e;return null},xt=function(t,e,n,r,i){var o=t[e];if(o)return o;var s=n[r].id;return t[e]={group:String(i),start:s,length:0},t[e]},Pt=function(t,e,n,r){for(var i={},o=null,s=0,a=0;a<e.length;a+=1){var u=e[a],c="string"==typeof u.named||"number"==typeof u.named,l=null;if(c){var f=e[a-1];f&&f.named===u.named&&o?l=o:o=l=h(u.named)}if(!t[s]){if(!1===e.slice(a).some((function(t){return!t.optional})))break;return[!1,null]}if(!0!==u.anything||!0!==u.greedy){if(!0===u.anything||!0===u.end&&!0===u.greedy&&n+s<r-1&&!0===t[s].doesMatch(Object.assign({},u,{end:!1}),n+s,r)||!0===t[s].doesMatch(u,n+s,r)){var p=s;if(u.optional&&e[a+1]&&!0===t[s].doesMatch(e[a+1],n+s,r)&&(t[s+1]&&!1!==t[s+1].doesMatch(e[a+1],n+s,r)||(a+=1)),s+=1,!0===u.end&&s!==t.length&&!0!==u.greedy)return[!1,null];if(!0===u.greedy){if(null===(s=At(t,s,Object.assign({},u,{start:!1,end:!1}),e[a+1],n,r)))return[!1,null];if(u.min&&u.min>s)return[!1,null];if(!0===u.end&&n+s!==r)return[!1,null]}if(c){var d=xt(i,l,t,p,u.named);s>1&&u.greedy?d.length+=s-p:d.length++}}else if(!0!==u.optional){if(!(t[s].isImplicit()&&e[a-1]&&t[s+1]&&t[s+1].doesMatch(u,n+s,r)))return[!1,null];s+=2}}else{var v=wt(t,s,e[a+1],u,n);if(void 0!==u.min&&v-s<u.min)return[!1,null];if(void 0!==u.max&&v-s>u.max){s+=u.max;continue}if(null===v)return[!1,null];c&&(xt(i,l,t,s,u.named).length=v-s),s=v}}return[t.slice(0,s),i]},jt=function(t,e,n){if(!n||0===n.length)return n;if(e.some((function(t){return t.end}))){var r=t[t.length-1];n=n.filter((function(t){return-1!==t.match.indexOf(r)}))}return n},Et=/\{([0-9]+,?[0-9]*)\}/,Ot=/&&/,Ct=new RegExp(/^<(\S+)>/),kt=function(t){return t[t.length-1]},Ft=function(t){return t[0]},Tt=function(t){return t.substr(1)},Nt=function(t){return t.substr(0,t.length-1)},Vt=function(t){return t=Tt(t),t=Nt(t)},$t=function t(e){for(var n,r={},i=0;i<2;i+=1){if("$"===kt(e)&&(r.end=!0,e=Nt(e)),"^"===Ft(e)&&(r.start=!0,e=Tt(e)),("["===Ft(e)||"]"===kt(e))&&(r.named=!0,"["===Ft(e)?r.groupType="]"===kt(e)?"single":"start":r.groupType="end",e=(e=e.replace(/^\[/,"")).replace(/\]$/,""),"<"===Ft(e))){var o=Ct.exec(e);o.length>=2&&(r.named=o[1],e=e.replace(o[0],""))}if("+"===kt(e)&&(r.greedy=!0,e=Nt(e)),"*"!==e&&"*"===kt(e)&&"\\*"!==e&&(r.greedy=!0,e=Nt(e)),"?"===kt(e)&&(r.optional=!0,e=Nt(e)),"!"===Ft(e)&&(r.negative=!0,e=Tt(e)),"("===Ft(e)&&")"===kt(e)){Ot.test(e)?(r.choices=e.split(Ot),r.operator="and"):(r.choices=e.split("|"),r.operator="or"),r.choices[0]=Tt(r.choices[0]);var s=r.choices.length-1;r.choices[s]=Nt(r.choices[s]),r.choices=r.choices.map((function(t){return t.trim()})),r.choices=r.choices.filter((function(t){return t})),r.choices=r.choices.map(t),e=""}if("/"===Ft(e)&&"/"===kt(e))return e=Vt(e),r.regex=new RegExp(e),r;if("~"===Ft(e)&&"~"===kt(e))return e=Vt(e),r.soft=!0,r.word=e,r}return!0===Et.test(e)&&(e=e.replace(Et,(function(t,e){var n=e.split(/,/g);return 1===n.length?(r.min=Number(n[0]),r.max=Number(n[0])):(r.min=Number(n[0]),r.max=Number(n[1]||999)),r.greedy=!0,""}))),"#"===Ft(e)?(r.tag=Tt(e),r.tag=(n=r.tag).charAt(0).toUpperCase()+n.substr(1),r):"@"===Ft(e)?(r.method=Tt(e),r):"."===e?(r.anything=!0,r):"*"===e?(r.anything=!0,r.greedy=!0,r.optional=!0,r):(e&&(e=(e=e.replace("\\*","*")).replace("\\.","."),r.word=e.toLowerCase()),r)},St=function(t){return t.filter((function(t){return t.groupType})).length>0&&(t=function(t){for(var e,n,r=!1,i=-1,o=0;o<t.length;o++){var s=t[o];"single"!==s.groupType||!0!==s.named?("start"===s.groupType&&(r=!0,e="string"==typeof(n=s.named)||"number"==typeof n?s.named:i+=1),r&&(s.named=e),"end"===s.groupType&&(r=!1)):(i+=1,s.named=i)}return t}(t)),t=function(t){return t.map((function(t){if(void 0!==t.choices&&!0===t.choices.every((function(t){return!0!==t.optional&&!0!==t.negative&&void 0!==t.word}))){var e={};t.choices.forEach((function(t){return e[t.word]=!0})),t.oneOf=e,delete t.choices}return t}))}(t)},Bt=function(e){if(null==e||""===e)return[];if("object"===t(e)){if(function(t){return"[object Array]"===Object.prototype.toString.call(t)}(e)){if(0===e.length||!e[0])return[];if("object"===t(e[0]))return e;if("string"==typeof e[0])return function(t){return[{choices:t.map((function(t){return{word:t}}))}]}(e)}return e&&"Doc"===e.isA?function(t){if(!t||!t.list||!t.list[0])return[];var e=[];return t.list.forEach((function(t){t.terms().forEach((function(t){e.push({id:t.id})}))})),[{choices:e,greedy:!0}]}(e):[]}"number"==typeof e&&(e=String(e));var n=function(t){var e=t.split(/([\^\[\!]*(?:<\S+>)?\(.*?\)[?+*]*\]?\$?)/);return e=e.map((function(t){return t.trim()}))}(e);return n=(n=function(t){var e=[];return t.forEach((function(t){if(/^[[^_/]?\(/.test(t[0]))e.push(t);else{var n=t.split(" ");n=n.filter((function(t){return t})),e=e.concat(n)}})),e}(n)).map($t),n=St(n)},It=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e&&(e=Bt(e)),!0===yt(t,e))return[];var r=e.filter((function(t){return!0!==t.optional})).length,i=t.terms(),o=[];if(!0===e[0].start){var s=Pt(i,e,0,i.length),a=u(s,2),c=a[0],h=a[1];return!1!==c&&c.length>0&&(c=c.filter((function(t){return t})),o.push({match:c,groups:h})),jt(i,e,o)}for(var l=0;l<i.length&&!(l+r>i.length);l+=1){var f=Pt(i.slice(l),e,l,i.length),p=u(f,2),d=p[0],v=p[1];if(!1!==d&&d.length>0&&(l+=d.length-1,d=d.filter((function(t){return t})),o.push({match:d,groups:v}),!0===n))return jt(i,e,o)}return jt(i,e,o)},Dt=function(t,e){var n={};It(t,e).forEach((function(t){t.match.forEach((function(t){n[t.id]=!0}))}));var r=t.terms(),i=[],o=[];return r.forEach((function(t){!0!==n[t.id]?o.push(t):o.length>0&&(i.push(o),o=[])})),o.length>0&&i.push(o),i},qt={match:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=It(this,t,n);return r=r.map((function(t){var n=t.match,r=t.groups,i=e.buildFrom(n[0].id,n.length,r);return i.cache.terms=n,i}))},has:function(t){return It(this,t,!0).length>0},not:function(t){var e=this,n=Dt(this,t);return n=n.map((function(t){return e.buildFrom(t[0].id,t.length)}))},canBe:function(t,e){for(var n=this,r=[],i=this.terms(),o=!1,s=0;s<i.length;s+=1){var a=i[s].canBe(t,e);!0===a&&(!0===o?r[r.length-1].push(i[s]):r.push([i[s]]),o=a)}return r=r.filter((function(t){return t.length>0})).map((function(t){return n.buildFrom(t[0].id,t.length)}))}},Lt=function t(n,r,i){e(this,t),this.start=n,this.length=r,this.isA="Phrase",Object.defineProperty(this,"pool",{enumerable:!1,writable:!0,value:i}),Object.defineProperty(this,"cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"groups",{enumerable:!1,writable:!0,value:{}})};Lt.prototype.buildFrom=function(t,e,n){var r=new Lt(t,e,this.pool);return n&&Object.keys(n).length>0?r.groups=n:r.groups=this.groups,r},Object.assign(Lt.prototype,qt),Object.assign(Lt.prototype,bt);var Mt={term:"terms"};Object.keys(Mt).forEach((function(t){return Lt.prototype[t]=Lt.prototype[Mt[t]]}));var zt=Lt,Wt=function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,t),Object.defineProperty(this,"words",{enumerable:!1,value:n})}return r(t,[{key:"add",value:function(t){return this.words[t.id]=t,this}},{key:"get",value:function(t){return this.words[t]}},{key:"remove",value:function(t){delete this.words[t]}},{key:"merge",value:function(t){return Object.assign(this.words,t.words),this}},{key:"stats",value:function(){return{words:Object.keys(this.words).length}}}]),t}();Wt.prototype.clone=function(){var t=this,e=Object.keys(this.words).reduce((function(e,n){var r=t.words[n].clone();return e[r.id]=r,e}),{});return new Wt(e)};var Ut=Wt,_t=function(t){t.forEach((function(e,n){n>0&&(e.prev=t[n-1].id),t[n+1]&&(e.next=t[n+1].id)}))},Ht=/(\S.+?[.!?\u203D\u2E18\u203C\u2047-\u2049])(?=\s+|$)/g,Gt=/\S/,Qt=/[ .][A-Z]\.? *$/i,Rt=/(?:\u2026|\.{2,}) *$/,Zt=/((?:\r?\n|\r)+)/,Jt=/[a-z0-9\u00C0-\u00FF\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]/i,Yt=/^\s+/,Kt=function(t,e){if(!0===Qt.test(t))return!1;if(!0===Rt.test(t))return!1;if(!1===Jt.test(t))return!1;var n=t.replace(/[.!?\u203D\u2E18\u203C\u2047-\u2049] *$/,"").split(" "),r=n[n.length-1].toLowerCase();return!e.hasOwnProperty(r)},Xt=function(t,e){var n=e.cache.abbreviations;t=t||"";var r=[],i=[];if(!(t=String(t))||"string"!=typeof t||!1===Gt.test(t))return r;for(var o=function(t){for(var e=[],n=t.split(Zt),r=0;r<n.length;r++)for(var i=n[r].split(Ht),o=0;o<i.length;o++)e.push(i[o]);return e}(t=t.replace(" "," ")),s=0;s<o.length;s++){var a=o[s];if(void 0!==a&&""!==a){if(!1===Gt.test(a)){if(i[i.length-1]){i[i.length-1]+=a;continue}if(o[s+1]){o[s+1]=a+o[s+1];continue}}i.push(a)}}for(var u=0;u<i.length;u++){var c=i[u];i[u+1]&&!1===Kt(c,n)?i[u+1]=c+(i[u+1]||""):c&&c.length>0&&(r.push(c),i[u]="")}if(0===r.length)return[t];for(var h=1;h<r.length;h+=1){var l=r[h].match(Yt);null!==l&&(r[h-1]+=l[0],r[h]=r[h].replace(Yt,""))}return r},te=/\S/,ee=/^[!?.]+$/,ne=/(\S+)/,re=/[a-z] ?\/ ?[a-z]*$/,ie={".":!0,"-":!0,"–":!0,"—":!0,"--":!0,"...":!0},oe=function(t){if(!0===/^(re|un)-?[^aeiou]./.test(t))return!1;return!0===/^([a-z\u00C0-\u00FF`"'/]+)(-|–|—)([a-z0-9\u00C0-\u00FF].*)/i.test(t)},se=function(t){var e=[],n=t.split(/[-–—]/),r="-",i=t.match(/[-–—]/);i&&i[0]&&(r=i);for(var o=0;o<n.length;o++)o===n.length-1?e.push(n[o]):e.push(n[o]+r);return e},ae=function(t){var e=[],n=[];if("number"==typeof(t=t||"")&&(t=String(t)),function(t){return"[object Array]"===Object.prototype.toString.call(t)}(t))return t;for(var r=t.split(ne),i=0;i<r.length;i++)!0!==oe(r[i])?n.push(r[i]):n=n.concat(se(r[i]));for(var o="",s=0;s<n.length;s++){var a=n[s];!0===te.test(a)&&!1===ie.hasOwnProperty(a)&&!1===ee.test(a)?(e.length>0?(e[e.length-1]+=o,e.push(a)):e.push(o+a),o=""):o+=a}return o&&(0===e.length&&(e[0]=""),e[e.length-1]+=o),e=(e=function(t){for(var e=1;e<t.length-1;e++)re.test(t[e])&&(t[e-1]+=t[e]+t[e+1],t[e]=null,t[e+1]=null);return t}(e)).filter((function(t){return t}))},ue=function(t){return"[object Array]"===Object.prototype.toString.call(t)},ce=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=null;"string"!=typeof t&&("number"==typeof t?t=String(t):ue(t)&&(r=t)),r=(r=r||Xt(t,e)).map((function(t){return ae(t)})),n=n||new Ut;var i=r.map((function(t){t=t.map((function(t){var e=new it(t);return n.add(e),e})),_t(t);var e=new zt(t[0].id,t.length,n);return e.cache.terms=t,e}));return i},he=function(t,e){var n=new Ut;return t.map((function(t,r){var i=t.terms.map((function(i,o){var s=new it(i.text);return s.pre=void 0!==i.pre?i.pre:"",void 0===i.post&&(i.post=" ",o>=t.terms.length-1&&(i.post=". ",r>=t.terms.length-1&&(i.post="."))),s.post=void 0!==i.post?i.post:" ",i.tags&&i.tags.forEach((function(t){return s.tag(t,"",e)})),n.add(s),s}));return _t(i),new zt(i[0].id,i.length,n)}))},le={},fe=["Person","Place","Organization"],pe={Noun:{notA:["Verb","Adjective","Adverb"]},Singular:{isA:"Noun",notA:"Plural"},ProperNoun:{isA:"Noun"},Person:{isA:["ProperNoun","Singular"],notA:["Place","Organization","Date"]},FirstName:{isA:"Person"},MaleName:{isA:"FirstName",notA:["FemaleName","LastName"]},FemaleName:{isA:"FirstName",notA:["MaleName","LastName"]},LastName:{isA:"Person",notA:["FirstName"]},NickName:{isA:"Person",notA:["FirstName","LastName"]},Honorific:{isA:"Noun",notA:["FirstName","LastName","Value"]},Place:{isA:"Singular",notA:["Person","Organization"]},Country:{isA:["Place","ProperNoun"],notA:["City"]},City:{isA:["Place","ProperNoun"],notA:["Country"]},Region:{isA:["Place","ProperNoun"]},Address:{isA:"Place"},Organization:{isA:["Singular","ProperNoun"],notA:["Person","Place"]},SportsTeam:{isA:"Organization"},School:{isA:"Organization"},Company:{isA:"Organization"},Plural:{isA:"Noun",notA:["Singular"]},Uncountable:{isA:"Noun"},Pronoun:{isA:"Noun",notA:fe},Actor:{isA:"Noun",notA:fe},Activity:{isA:"Noun",notA:["Person","Place"]},Unit:{isA:"Noun",notA:fe},Demonym:{isA:["Noun","ProperNoun"],notA:fe},Possessive:{isA:"Noun"}},de={Verb:{notA:["Noun","Adjective","Adverb","Value"]},PresentTense:{isA:"Verb",notA:["PastTense","Copula","FutureTense"]},Infinitive:{isA:"PresentTense",notA:["PastTense","Gerund"]},Gerund:{isA:"PresentTense",notA:["PastTense","Copula","FutureTense"]},PastTense:{isA:"Verb",notA:["FutureTense"]},FutureTense:{isA:"Verb"},Copula:{isA:"Verb"},Modal:{isA:"Verb",notA:["Infinitive"]},PerfectTense:{isA:"Verb",notA:"Gerund"},Pluperfect:{isA:"Verb"},Participle:{isA:"Verb"},PhrasalVerb:{isA:"Verb"},Particle:{isA:"PhrasalVerb"}},ve={Value:{notA:["Verb","Adjective","Adverb"]},Ordinal:{isA:"Value",notA:["Cardinal"]},Cardinal:{isA:"Value",notA:["Ordinal"]},RomanNumeral:{isA:"Cardinal",notA:["Ordinal","TextValue"]},TextValue:{isA:"Value",notA:["NumericValue"]},NumericValue:{isA:"Value",notA:["TextValue"]},Money:{isA:"Cardinal"},Percent:{isA:"Value"}},me=["Noun","Verb","Adjective","Adverb","Value","QuestionWord"],ge={Adjective:{notA:["Noun","Verb","Adverb","Value"]},Comparable:{isA:["Adjective"]},Comparative:{isA:["Adjective"]},Superlative:{isA:["Adjective"],notA:["Comparative"]},NumberRange:{isA:["Contraction"]},Adverb:{notA:["Noun","Verb","Adjective","Value"]},Date:{notA:["Verb","Conjunction","Adverb","Preposition","Adjective"]},Month:{isA:["Date","Singular"],notA:["Year","WeekDay","Time"]},WeekDay:{isA:["Date","Noun"]},Time:{isA:["Date"],notA:["Value"]},Determiner:{notA:me},Conjunction:{notA:me},Preposition:{notA:me},QuestionWord:{notA:["Determiner"]},Currency:{},Expression:{notA:["Noun","Adjective","Verb","Adverb"]},Abbreviation:{},Url:{notA:["HashTag","PhoneNumber","Verb","Adjective","Value","AtMention","Email"]},PhoneNumber:{notA:["HashTag","Verb","Adjective","Value","AtMention","Email"]},HashTag:{},AtMention:{isA:["Noun"],notA:["HashTag","Verb","Adjective","Value","Email"]},Emoji:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Emoticon:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Email:{notA:["HashTag","Verb","Adjective","Value","AtMention"]},Auxiliary:{notA:["Noun","Adjective","Value"]},Acronym:{notA:["Plural","RomanNumeral"]},Negative:{notA:["Noun","Adjective","Value"]},Condition:{notA:["Verb","Adjective","Noun","Value"]}},be={Noun:"blue",Verb:"green",Negative:"green",Date:"red",Value:"red",Adjective:"magenta",Preposition:"cyan",Conjunction:"cyan",Determiner:"cyan",Adverb:"cyan"},ye=function(t){return Object.keys(t).forEach((function(e){t[e].color?t[e].color=t[e].color:be[e]?t[e].color=be[e]:t[e].isA.some((function(n){return!!be[n]&&(t[e].color=be[n],!0)}))})),t},Ae=function(t){return Object.keys(t).forEach((function(e){for(var n=t[e],r=n.isA.length,i=0;i<r;i++){var o=n.isA[i];t[o]&&(n.isA=n.isA.concat(t[o].isA))}n.isA=function(t){return t.filter((function(t,e,n){return n.indexOf(t)===e}))}(n.isA)})),t},we=function(t){var e=Object.keys(t);return e.forEach((function(n){var r=t[n];r.notA=r.notA||[],r.isA.forEach((function(e){if(t[e]&&t[e].notA){var n="string"==typeof t[e].notA?[t[e].isA]:t[e].notA||[];r.notA=r.notA.concat(n)}}));for(var i=0;i<e.length;i++){var o=e[i];-1!==t[o].notA.indexOf(n)&&r.notA.push(o)}r.notA=function(t){return t.filter((function(t,e,n){return n.indexOf(t)===e}))}(r.notA)})),t},xe=function(t){var e=Object.keys(t);return e.forEach((function(n){var r=t[n];r.lineage=[];for(var i=0;i<e.length;i++)-1!==t[e[i]].isA.indexOf(n)&&r.lineage.push(e[i])})),t},Pe=function(t){return t=function(t){return Object.keys(t).forEach((function(e){var n=t[e];n.isA=n.isA||[],"string"==typeof n.isA&&(n.isA=[n.isA]),n.notA=n.notA||[],"string"==typeof n.notA&&(n.notA=[n.notA])})),t}(t),t=Ae(t),t=we(t),t=ye(t),t=xe(t)},je=function(t,e){Object.keys(t).forEach((function(n){e[n]=t[n]}))},Ee=function(){var t={};return je(pe,t),je(de,t),je(ve,t),je(ge,t),t=Pe(t)}(),Oe=function(t){return t},Ce=function(t,e,n){void 0!==n[t]?("string"==typeof n[t]&&(n[t]=[n[t]]),"string"==typeof e?n[t].push(e):n[t]=n[t].concat(e)):n[t]=e},ke=Ce,Fe=function(t,e,n){var r=n.words,i=n.transforms,o=t.split(" ");if(o.length>1&&(n.hasCompound[o[0]]=!0),"Singular"===e){var s=i.toPlural(t,n);r[s]=r[s]||"Plural"}if("Infinitive"===e)for(var a=i.conjugate(t,n),u=Object.keys(a),c=0;c<u.length;c++){var h=a[u[c]];r[h]=r[h]||u[c]}if("Comparable"===e)for(var l=i.adjectives(t),f=Object.keys(l),p=0;p<f.length;p++){var d=l[f[p]];r[d]=r[d]||f[p]}if("PhrasalVerb"===e){Ce(t,"Infinitive",r);for(var v=i.conjugate(o[0],n),m=Object.keys(v),g=0;g<m.length;g++){n.hasCompound[v[m[g]]]=!0;var b=v[m[g]]+" "+o[1];Ce(b,m[g],r),Ce(b,"PhrasalVerb",r)}}if("Demonym"===e){var y=i.toPlural(t,n);r[y]=r[y]||["Demonym","Plural"]}},Te=function(t){for(var e=t.irregulars.nouns,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];t.words[i]="Singular",t.words[e[i]]="Plural"}for(var o=t.irregulars.verbs,s=Object.keys(o),a=function(e){var n=s[e];t.words[n]=t.words[n]||"Infinitive";var r=t.transforms.conjugate(n,t);r=Object.assign(r,o[n]),Object.keys(r).forEach((function(e){t.words[r[e]]=t.words[r[e]]||e}))},u=0;u<s.length;u++)a(u)},Ne={nouns:le,verbs:le},Ve={conjugate:Oe,adjectives:Oe,toPlural:Oe,toSingular:Oe,toInfinitive:Oe},$e=!1,Se=function(){function t(){e(this,t),Object.defineProperty(this,"words",{enumerable:!1,value:le,writable:!0}),Object.defineProperty(this,"hasCompound",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"irregulars",{enumerable:!1,value:Ne,writable:!0}),Object.defineProperty(this,"tags",{enumerable:!1,value:Object.assign({},Ee),writable:!0}),Object.defineProperty(this,"transforms",{enumerable:!1,value:Ve,writable:!0}),Object.defineProperty(this,"taggers",{enumerable:!1,value:[],writable:!0}),this.unpackWords(le),this.addIrregulars(),Object.defineProperty(this,"cache",{enumerable:!1,value:{abbreviations:this.getByTag("Abbreviation")}})}return r(t,[{key:"verbose",value:function(t){return $e=t,this}},{key:"isVerbose",value:function(){return $e}},{key:"getByTag",value:function(t){for(var e=this.words,n={},r=Object.keys(e),i=0;i<r.length;i++)"string"==typeof e[r[i]]?e[r[i]]===t&&(n[r[i]]=!0):e[r[i]].some((function(e){return e===t}))&&(n[r[i]]=!0);return n}},{key:"unpackWords",value:function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)for(var r=Object.keys(t[e[n]]),i=0;i<r.length;i++)ke(r[i],e[n],this.words),Fe(r[i],e[n],this)}},{key:"addWords",value:function(t){for(var e=Object.keys(t),n=0;n<e.length;n++){var r=e[n].toLowerCase();ke(r,t[e[n]],this.words),Fe(r,t[e[n]],this)}}},{key:"addIrregulars",value:function(){return Te(this),this}},{key:"addTags",value:function(t){return t=Object.assign({},t),this.tags=Object.assign(this.tags,t),this.tags=Pe(this.tags),this}},{key:"postProcess",value:function(t){return this.taggers.push(t),this}},{key:"stats",value:function(){return{words:Object.keys(this.words).length,plurals:Object.keys(this.irregulars.nouns).length,conjugations:Object.keys(this.irregulars.verbs).length,compounds:Object.keys(this.hasCompound).length,postProcessors:this.taggers.length}}}]),t}(),Be=function(t){return JSON.parse(JSON.stringify(t))};Se.prototype.clone=function(){var t=new Se;return t.words=Object.assign({},this.words),t.hasCompound=Object.assign({},this.hasCompound),t.irregulars=Be(this.irregulars),t.tags=Be(this.tags),t.transforms=this.transforms,t.taggers=this.taggers,t};var Ie=Se,De=F((function(t,e){e.all=function(){return this.parents()[0]||this},e.parent=function(){return this.from?this.from:this},e.parents=function(t){var e=[];return function t(n){n.from&&(e.push(n.from),t(n.from))}(this),e=e.reverse(),"number"==typeof t?e[t]:e},e.clone=function(t){var e=this.list.map((function(e){return e.clone(t)}));return this.buildFrom(e)},e.wordCount=function(){return this.list.reduce((function(t,e){return t+=e.wordCount()}),0)},e.wordcount=e.wordCount})),qe=(De.all,De.parent,De.parents,De.clone,De.wordCount,De.wordcount,F((function(t,e){e.first=function(t){return void 0===t?this.get(0):this.slice(0,t)},e.last=function(t){if(void 0===t)return this.get(this.list.length-1);var e=this.list.length;return this.slice(e-t,e)},e.slice=function(t,e){var n=this.list.slice(t,e);return this.buildFrom(n)},e.eq=function(t){var e=this.list[t];return void 0===e?this.buildFrom([]):this.buildFrom([e])},e.get=e.eq,e.firstTerms=function(){return this.match("^.")},e.firstTerm=e.firstTerms,e.lastTerms=function(){return this.match(".$")},e.lastTerm=e.lastTerms,e.termList=function(t){for(var e=[],n=0;n<this.list.length;n++)for(var r=this.list[n].terms(),i=0;i<r.length;i++)if(e.push(r[i]),void 0!==t&&void 0!==e[t])return e[t];return e};e.groups=function(t){return void 0===t?function(t){for(var e={},n={},r=function(e){for(var r=t.list[e],i=Object.keys(r.groups).map((function(t){return r.groups[t]})),o=0;o<i.length;o++){var s=i[o],a=s.group,u=s.start,c=s.length;n[a]||(n[a]=[]),n[a].push(r.buildFrom(u,c))}},i=0;i<t.list.length;i++)r(i);for(var o=Object.keys(n),s=0;s<o.length;s++){var a=o[s];e[a]=t.buildFrom(n[a])}return e}(this):("number"==typeof t&&(t=String(t)),function(t,e){for(var n=[],r=function(r){var i=t.list[r],o=Object.keys(i.groups);(o=o.filter((function(t){return i.groups[t].group===e}))).forEach((function(t){n.push(i.buildFrom(i.groups[t].start,i.groups[t].length))}))},i=0;i<t.list.length;i++)r(i);return t.buildFrom(n)}(this,t)||this.buildFrom([]))},e.group=e.groups,e.sentences=function(t){var e=[];return this.list.forEach((function(t){e.push(t.fullSentence())})),"number"==typeof t?this.buildFrom([e[t]]):this.buildFrom(e)},e.sentence=e.sentences}))),Le=(qe.first,qe.last,qe.slice,qe.eq,qe.get,qe.firstTerms,qe.firstTerm,qe.lastTerms,qe.lastTerm,qe.termList,qe.groups,qe.group,qe.sentences,qe.sentence,function(t,e){if(t._cache&&!0===t._cache.set){for(var n=(a=[],u=[],e.forEach((function(t){!0!==t.optional&&!0!==t.negative&&(void 0!==t.tag&&a.push(t.tag),void 0!==t.word&&u.push(t.word))})),{tags:a,words:u}),r=n.words,i=n.tags,o=0;o<r.length;o++)if(void 0===t._cache.words[r[o]])return!1;for(var s=0;s<i.length;s++)if(void 0===t._cache.tags[i[s]])return!1}var a,u;return!0}),Me=F((function(t,e){e.match=function(t,e){var n=Bt(t);if(0===n.length)return this.buildFrom([]);if(!1===Le(this,n))return this.buildFrom([]);var r=this.list.reduce((function(t,e){return t.concat(e.match(n))}),[]);return null!=e&&""!==e?this.buildFrom(r).groups(e):this.buildFrom(r)},e.not=function(t){var e=Bt(t);if(0===e.length||!1===Le(this,e))return this;var n=this.list.reduce((function(t,n){return t.concat(n.not(e))}),[]);return this.buildFrom(n)},e.matchOne=function(t){var e=Bt(t);if(!1===Le(this,e))return this.buildFrom([]);for(var n=0;n<this.list.length;n++){var r=this.list[n].match(e,!0);return this.buildFrom(r)}return this.buildFrom([])},e.if=function(t){var e=Bt(t);if(!1===Le(this,e))return this.buildFrom([]);var n=this.list.filter((function(t){return!0===t.has(e)}));return this.buildFrom(n)},e.ifNo=function(t){var e=Bt(t),n=this.list.filter((function(t){return!1===t.has(e)}));return this.buildFrom(n)},e.has=function(t){var e=Bt(t);return!1!==Le(this,e)&&this.list.some((function(t){return!0===t.has(e)}))},e.lookAhead=function(t){t||(t=".*");var e=Bt(t),n=[];return this.list.forEach((function(t){n=n.concat(t.lookAhead(e))})),n=n.filter((function(t){return t})),this.buildFrom(n)},e.lookAfter=e.lookAhead,e.lookBehind=function(t){t||(t=".*");var e=Bt(t),n=[];return this.list.forEach((function(t){n=n.concat(t.lookBehind(e))})),n=n.filter((function(t){return t})),this.buildFrom(n)},e.lookBefore=e.lookBehind,e.before=function(t){var e=Bt(t),n=this.if(e).list.map((function(t){var n=t.terms().map((function(t){return t.id})),r=t.match(e)[0],i=n.indexOf(r.start);return 0===i||-1===i?null:t.buildFrom(t.start,i)}));return n=n.filter((function(t){return null!==t})),this.buildFrom(n)},e.after=function(t){var e=Bt(t),n=this.if(e).list.map((function(t){var n=t.terms(),r=n.map((function(t){return t.id})),i=t.match(e)[0],o=r.indexOf(i.start);if(-1===o||!n[o+i.length])return null;var s=n[o+i.length].id,a=t.length-o-i.length;return t.buildFrom(s,a)}));return n=n.filter((function(t){return null!==t})),this.buildFrom(n)},e.hasAfter=function(t){return this.filter((function(e){return e.lookAfter(t).found}))},e.hasBefore=function(t){return this.filter((function(e){return e.lookBefore(t).found}))}})),ze=(Me.match,Me.not,Me.matchOne,Me.ifNo,Me.has,Me.lookAhead,Me.lookAfter,Me.lookBehind,Me.lookBefore,Me.before,Me.after,Me.hasAfter,Me.hasBefore,function(t,e,n,r){var i=[];"string"==typeof t&&(i=t.split(" ")),e.list.forEach((function(o){var s=o.terms();!0===n&&(s=s.filter((function(n){return n.canBe(t,e.world)}))),s.forEach((function(n,o){i.length>1?i[o]&&"."!==i[o]&&n.tag(i[o],r,e.world):n.tag(t,r,e.world)}))}))}),We={tag:function(t,e){return t?(ze(t,this,!1,e),this):this},tagSafe:function(t,e){return t?(ze(t,this,!0,e),this):this},unTag:function(t,e){var n=this;return this.list.forEach((function(r){r.terms().forEach((function(r){return r.unTag(t,e,n.world)}))})),this},canBe:function(t){if(!t)return this;var e=this.world,n=this.list.reduce((function(n,r){return n.concat(r.canBe(t,e))}),[]);return this.buildFrom(n)}},Ue={map:function(e){var n=this;if(!e)return this;var r=this.list.map((function(t,r){var i=n.buildFrom([t]);i.from=null;var o=e(i,r);return o&&o.list&&o.list[0]?o.list[0]:o}));return 0===(r=r.filter((function(t){return t}))).length?this.buildFrom(r):"object"!==t(r[0])||"Phrase"!==r[0].isA?r:this.buildFrom(r)},forEach:function(t,e){var n=this;return t?(this.list.forEach((function(r,i){var o=n.buildFrom([r]);!0===e&&(o.from=null),t(o,i)})),this):this},filter:function(t){var e=this;if(!t)return this;var n=this.list.filter((function(n,r){var i=e.buildFrom([n]);return i.from=null,t(i,r)}));return this.buildFrom(n)},find:function(t){var e=this;if(!t)return this;var n=this.list.find((function(n,r){var i=e.buildFrom([n]);return i.from=null,t(i,r)}));return n?this.buildFrom([n]):void 0},some:function(t){var e=this;return t?this.list.some((function(n,r){var i=e.buildFrom([n]);return i.from=null,t(i,r)})):this},random:function(t){if(!this.found)return this;var e=Math.floor(Math.random()*this.list.length);if(void 0===t){var n=[this.list[e]];return this.buildFrom(n)}return e+t>this.length&&(e=(e=this.length-t)<0?0:e),this.slice(e,e+t)}},_e=function(t){return t.split(/[ -]/g)},He=function(t,e,n){for(var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={};return t.forEach((function(t,r){var i=!0;void 0!==e[r]&&(i=e[r]),t=(t=(t||"").toLowerCase()).replace(/[,;.!?]+$/,"");var o=_e(t).map((function(t){return t.trim()}));n[o[0]]=n[o[0]]||{},1===o.length?n[o[0]].value=i:(n[o[0]].more=n[o[0]].more||[],n[o[0]].more.push({rest:o.slice(1),value:i}))})),n}(t,e),i=[],o=function(t){for(var e=n.list[t],o=e.terms().map((function(t){return t.reduced})),s=function(t){void 0!==r[o[t]]&&(void 0!==r[o[t]].more&&r[o[t]].more.forEach((function(n){void 0!==o[t+n.rest.length]&&(!0===n.rest.every((function(e,n){return e===o[t+n+1]}))&&i.push({id:e.terms()[t].id,value:n.value,length:n.rest.length+1}))})),void 0!==r[o[t]].value&&i.push({id:e.terms()[t].id,value:r[o[t]].value,length:1}))},a=0;a<o.length;a++)s(a)},s=0;s<n.list.length;s++)o(s);return i},Ge=F((function(t,e){e.lookup=function(t){var e,n=this,r=[],i=(e=t)&&"[object Object]"===Object.prototype.toString.call(e);!0===i&&(t=Object.keys(t).map((function(e){return r.push(t[e]),e}))),"string"==typeof t&&(t=[t]),!0!==this._cache.set&&this.cache();var o=He(t,r,this),s=this.list[0];if(!0===i){var a={};return o.forEach((function(t){a[t.value]=a[t.value]||[],a[t.value].push(s.buildFrom(t.id,t.length))})),Object.keys(a).forEach((function(t){a[t]=n.buildFrom(a[t])})),a}return o=o.map((function(t){return s.buildFrom(t.id,t.length)})),this.buildFrom(o)},e.lookUp=e.lookup})),Qe=(Ge.lookup,Ge.lookUp,{cache:function(t){var e=this;t=t||{};var n={},r={};return this._cache.words=n,this._cache.tags=r,this._cache.set=!0,this.list.forEach((function(i,o){i.cache=i.cache||{},i.terms().forEach((function(i){n[i.reduced]&&!n.hasOwnProperty(i.reduced)||(n[i.reduced]=n[i.reduced]||[],n[i.reduced].push(o),Object.keys(i.tags).forEach((function(t){r[t]=r[t]||[],r[t].push(o)})),t.root&&(i.setRoot(e.world),n[i.root]=!0))}))})),this},uncache:function(){return this._cache={},this.list.forEach((function(t){t.cache={}})),this.parents().forEach((function(t){t._cache={},t.list.forEach((function(t){t.cache={}}))})),this}}),Re=function(t){return t.charAt(0).toUpperCase()+t.substr(1)},Ze={replaceWith:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?(!0===r&&(r={keepTags:!0}),!1===r&&(r={keepTags:!1}),r=r||{},this.uncache(),this.list.forEach((function(i){var o,s=e;if("function"==typeof e&&(s=e(i)),s&&"object"===t(s)&&"Doc"===s.isA)o=s.list,n.pool().merge(s.pool());else{if("string"!=typeof s)return;!1!==r.keepCase&&i.terms(0).isTitleCase()&&(s=Re(s)),o=ce(s,n.world,n.pool());var a=n.buildFrom(o);a.tagger(),o=a.list}if(!0===r.keepTags){var u=i.json({terms:{tags:!0}}).terms;o[0].terms().forEach((function(t,e){u[e]&&t.tagSafe(u[e].tags,"keptTag",n.world)}))}i.replace(o[0],n)})),this):this.delete()},replace:function(t,e,n){return void 0===e?this.replaceWith(t,n):(this.match(t).replaceWith(e,n),this)}},Je=F((function(t,e){e.append=function(t){var e=this;return t?(this.uncache(),this.list.forEach((function(n){var r=ce(t,e.world,e.pool())[0];e.buildFrom([r]).tagger(),n.append(r,e)})),this):this},e.insertAfter=e.append,e.insertAt=e.append,e.prepend=function(t){var e=this;return t?(this.uncache(),this.list.forEach((function(n){var r=ce(t,e.world,e.pool())[0];e.buildFrom([r]).tagger(),n.prepend(r,e)})),this):this},e.insertBefore=e.prepend,e.concat=function(){this.uncache();for(var t=this.list.slice(0),e=0;e<arguments.length;e++){var n=arguments[e];if("string"==typeof n){var r=ce(n,this.world);t=t.concat(r)}else"Doc"===n.isA?t=t.concat(n.list):"Phrase"===n.isA&&t.push(n)}return this.buildFrom(t)},e.delete=function(t){var e=this;this.uncache();var n=this;return t&&(n=this.match(t)),n.list.forEach((function(t){return t.delete(e)})),this},e.remove=e.delete})),Ye=(Je.append,Je.insertAfter,Je.insertAt,Je.prepend,Je.insertBefore,Je.concat,Je.remove,{clean:!0,reduced:!0,root:!0}),Ke={text:function(e){var n=this;e=e||{};var r=!1;0===this.parents().length&&(r=!0),("root"===e||"object"===t(e)&&e.root)&&this.list.forEach((function(t){t.terms().forEach((function(t){null===t.root&&t.setRoot(n.world)}))}));var i=this.list.reduce((function(t,i,o){var s=!r&&0===o,a=!r&&o===n.list.length-1;return t+i.text(e,s,a)}),"");return!0!==Ye[e]&&!0!==e.reduced&&!0!==e.clean&&!0!==e.root||(i=i.trim()),i}},Xe=function(t,e,n){var r=function(t){var e=0,n=0,r={};return t.termList().forEach((function(t){r[t.id]={index:n,start:e+t.pre.length,length:t.text.length},e+=t.pre.length+t.text.length+t.post.length,n+=1})),r}(t.all());(n.terms.index||n.index)&&e.forEach((function(t){t.terms.forEach((function(t){t.index=r[t.id].index})),t.index=t.terms[0].index})),(n.terms.offset||n.offset)&&e.forEach((function(t){t.terms.forEach((function(t){t.offset=r[t.id]||{}})),t.offset={index:t.terms[0].offset.index,start:t.terms[0].offset.start-t.text.indexOf(t.terms[0].text),length:t.text.length}}))},tn=F((function(t,e){var n={text:!0,terms:!0,trim:!0},r=function(t){return(t=Object.assign({},n,t)).unique&&(t.reduced=!0),t.offset&&(t.text=!0,t.terms&&!0!==t.terms||(t.terms={}),t.terms.offset=!0),(t.index||t.terms.index)&&(t.terms=!0===t.terms?{}:t.terms,t.terms.id=!0),t};e.json=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("number"==typeof e&&this.list[e])return this.list[e].json(n);!0===(e=r(e)).root&&this.list.forEach((function(e){e.terms().forEach((function(e){null===e.root&&e.setRoot(t.world)}))}));var i=this.list.map((function(n){return n.json(e,t.world)}));if((e.terms.offset||e.offset||e.terms.index||e.index)&&Xe(this,i,e),e.frequency||e.freq||e.count){var o={};this.list.forEach((function(t){var e=t.text("reduced");o[e]=o[e]||0,o[e]+=1})),this.list.forEach((function(t,e){i[e].count=o[t.text("reduced")]}))}if(e.unique){var s={};i=i.filter((function(t){return!0!==s[t.reduced]&&(s[t.reduced]=!0,!0)}))}return i},e.data=e.json})),en=(tn.json,tn.data,F((function(t){var e=function(t,e){for(t=t.toString();t.length<e;)t+=" ";return t};var n={green:"#7f9c6c",red:"#914045",blue:"#6699cc",magenta:"#6D5685",cyan:"#2D85A8",yellow:"#e6d7b3",black:"#303b50"},r={green:function(t){return"[32m"+t+"[0m"},red:function(t){return"[31m"+t+"[0m"},blue:function(t){return"[34m"+t+"[0m"},magenta:function(t){return"[35m"+t+"[0m"},cyan:function(t){return"[36m"+t+"[0m"},yellow:function(t){return"[33m"+t+"[0m"},black:function(t){return"[30m"+t+"[0m"}};t.exports=function(t){return"undefined"!=typeof window&&window.document?(function(t){var r=t.world.tags;t.list.forEach((function(t){console.log('\n%c"'+t.text()+'"',"color: #e6d7b3;"),t.terms().forEach((function(t){var i=Object.keys(t.tags),o=t.text||"-";t.implicit&&(o="["+t.implicit+"]");var s="'"+o+"'";s=e(s,8);var a=i.find((function(t){return r[t]&&r[t].color})),u="steelblue";r[a]&&(u=r[a].color,u=n[u]),console.log("   ".concat(s,"  -  %c").concat(i.join(", ")),"color: ".concat(u||"steelblue",";"))}))}))}(t),t):(console.log(r.blue("=====")),t.list.forEach((function(n){console.log(r.blue("  -----")),n.terms().forEach((function(n){var i=Object.keys(n.tags),o=n.text||"-";n.implicit&&(o="["+n.implicit+"]");var s="'"+(o=r.yellow(o))+"'";s=e(s,18);var a=r.blue("  ｜ ")+s+"  - "+function(t,e){return(t=t.map((function(t){if(!e.tags.hasOwnProperty(t))return t;var n=e.tags[t].color||"blue";return r[n](t)}))).join(", ")}(i,t.world);console.log(a)}))})),console.log(""),t)}}))),nn=function(t){var e=t.json({text:!1,terms:!1,reduced:!0}),n={};e.forEach((function(t){n[t.reduced]||(t.count=0,n[t.reduced]=t),n[t.reduced].count+=1}));var r=Object.keys(n).map((function(t){return n[t]}));return r.sort((function(t,e){return t.count>e.count?-1:t.count<e.count?1:0})),r},rn={debug:function(){return en(this),this},out:function(t){if("text"===t)return this.text();if("normal"===t)return this.text("normal");if("json"===t)return this.json();if("offset"===t||"offsets"===t)return this.json({offset:!0});if("array"===t)return this.json({terms:!1}).map((function(t){return t.text}));if("freq"===t||"frequency"===t)return nn(this);if("terms"===t){var e=[];return this.json({text:!1,terms:{text:!0}}).forEach((function(t){var n=t.terms.map((function(t){return t.text}));n=n.filter((function(t){return t})),e=e.concat(n)})),e}return"tags"===t?this.list.map((function(t){return t.terms().reduce((function(t,e){return t[e.clean||e.implicit]=Object.keys(e.tags),t}),{})})):"debug"===t?(en(this),this):this.text()}},on={alpha:function(t,e){var n=t.text("clean"),r=e.text("clean");return n<r?-1:n>r?1:0},length:function(t,e){var n=t.text().trim().length,r=e.text().trim().length;return n<r?1:n>r?-1:0},wordCount:function(t,e){var n=t.wordCount(),r=e.wordCount();return n<r?1:n>r?-1:0}};on.alphabetical=on.alpha,on.wordcount=on.wordCount;var sn={index:!0,sequence:!0,seq:!0,sequential:!0,chron:!0,chronological:!0},an={sort:function(t){return"freq"===(t=t||"alpha")||"frequency"===t||"topk"===t?(n={},r={case:!0,punctuation:!1,whitespace:!0,unicode:!0},(e=this).list.forEach((function(t){var e=t.text(r);n[e]=n[e]||0,n[e]+=1})),e.list.sort((function(t,e){var i=n[t.text(r)],o=n[e.text(r)];return i<o?1:i>o?-1:0})),e):sn.hasOwnProperty(t)?function(t){var e={};return t.json({terms:{offset:!0}}).forEach((function(t){e[t.terms[0].id]=t.terms[0].offset.start})),t.list=t.list.sort((function(t,n){return e[t.start]>e[n.start]?1:e[t.start]<e[n.start]?-1:0})),t}(this):"function"==typeof(t=on[t]||t)?(this.list=this.list.sort(t),this):this;var e,n,r},reverse:function(){var t=[].concat(this.list);return t=t.reverse(),this.buildFrom(t)},unique:function(){var t=[].concat(this.list),e={};return t=t.filter((function(t){var n=t.text("reduced").trim();return!0!==e.hasOwnProperty(n)&&(e[n]=!0,!0)})),this.buildFrom(t)}},un=/[\[\]{}⟨⟩:,،、‒–—―…‹›«»‐\-;\/⁄·*\•^†‡°¡¿※№÷×ºª%‰=‱¶§~|‖¦©℗®℠™¤₳฿]/g,cn=/['‘’“”"′″‴]+/g,hn={whitespace:function(t){var e=t.list.map((function(t){return t.terms()}));e.forEach((function(t,n){t.forEach((function(r,i){!0!==r.hasDash()?(r.pre=r.pre.replace(/\s/g,""),r.post=r.post.replace(/\s/g,""),(t.length-1!==i||e[n+1])&&(r.implicit&&!0===Boolean(r.text)||!0!==r.hasHyphen()&&(r.post+=" "))):r.post=" - "}))}))},punctuation:function(t){t.forEach((function(t){!0===t.hasHyphen()&&(t.post=" "),t.pre=t.pre.replace(un,""),t.post=t.post.replace(un,""),t.post=t.post.replace(/\.\.\./,""),!0===/!/.test(t.post)&&(t.post=t.post.replace(/!/g,""),t.post="!"+t.post),!0===/\?/.test(t.post)&&(t.post=t.post.replace(/[\?!]*/,""),t.post="?"+t.post)}))},unicode:function(t){t.forEach((function(t){!0!==t.isImplicit()&&(t.text=p(t.text))}))},quotations:function(t){t.forEach((function(t){t.post=t.post.replace(cn,""),t.pre=t.pre.replace(cn,"")}))},adverbs:function(t){t.match("#Adverb").not("(not|nary|seldom|never|barely|almost|basically|so)").remove()},abbreviations:function(t){t.list.forEach((function(t){var e=t.terms();e.forEach((function(t,n){!0===t.tags.Abbreviation&&e[n+1]&&(t.post=t.post.replace(/^\./,""))}))}))}},ln={whitespace:!0,unicode:!0,punctuation:!0,emoji:!0,acronyms:!0,abbreviations:!0,case:!1,contractions:!1,parentheses:!1,quotations:!1,adverbs:!1,possessives:!1,verbs:!1,nouns:!1,honorifics:!1},fn={light:{},medium:{case:!0,contractions:!0,parentheses:!0,quotations:!0,adverbs:!0}};fn.heavy=Object.assign({},fn.medium,{possessives:!0,verbs:!0,nouns:!0,honorifics:!0});var pn={normalize:function(t){"string"==typeof(t=t||{})&&(t=fn[t]||{}),t=Object.assign({},ln,t),this.uncache();var e=this.termList();return t.case&&this.toLowerCase(),t.whitespace&&hn.whitespace(this),t.unicode&&hn.unicode(e),t.punctuation&&hn.punctuation(e),t.emoji&&this.remove("(#Emoji|#Emoticon)"),t.acronyms&&this.acronyms().strip(),t.abbreviations&&hn.abbreviations(this),(t.contraction||t.contractions)&&this.contractions().expand(),t.parentheses&&this.parentheses().unwrap(),(t.quotations||t.quotes)&&hn.quotations(e),t.adverbs&&hn.adverbs(this),(t.possessive||t.possessives)&&this.possessives().strip(),t.verbs&&this.verbs().toInfinitive(),(t.nouns||t.plurals)&&this.nouns().toSingular(),t.honorifics&&this.remove("#Honorific"),this}},dn=F((function(t,e){e.splitOn=function(t){if(!t)return this.parent().splitOn(this);var e=Bt(t),n=[];return this.list.forEach((function(t){var r=t.match(e);if(0!==r.length){var i=t;r.forEach((function(t){var e=i.splitOn(t);e.before&&n.push(e.before),e.match&&n.push(e.match),i=e.after})),i&&n.push(i)}else n.push(t)})),this.buildFrom(n)},e.splitAfter=function(t){if(!t)return this.parent().splitAfter(this);var e=Bt(t),n=[];return this.list.forEach((function(t){var r=t.match(e);if(0!==r.length){var i=t;r.forEach((function(t){var e=i.splitOn(t);e.before&&e.match?(e.before.length+=e.match.length,n.push(e.before)):e.match&&n.push(e.match),i=e.after})),i&&n.push(i)}else n.push(t)})),this.buildFrom(n)},e.split=e.splitAfter,e.splitBefore=function(t){if(!t)return this.parent().splitBefore(this);var e=Bt(t),n=[];return this.list.forEach((function(t){var r=t.match(e);if(0!==r.length){var i=t;r.forEach((function(t){var e=i.splitOn(t);e.before&&n.push(e.before),e.match&&e.after&&(e.match.length+=e.after.length),i=e.match})),i&&n.push(i)}else n.push(t)})),this.buildFrom(n)},e.segment=function(t,e){t=t||{},e=e||{text:!0};var n=this,r=Object.keys(t);return r.forEach((function(t){n=n.splitOn(t)})),n.list.forEach((function(e){for(var n=0;n<r.length;n+=1)if(e.has(r[n]))return void(e.segment=t[r[n]])})),n.list.map((function(t){var n=t.json(e);return n.segment=t.segment||null,n}))}})),vn=(dn.splitOn,dn.splitAfter,dn.split,dn.splitBefore,dn.segment,function(t,e){var n=t.world;return t.list.forEach((function(t){t.terms().forEach((function(t){return t[e](n)}))})),t}),mn={toLowerCase:function(){return vn(this,"toLowerCase")},toUpperCase:function(){return vn(this,"toUpperCase")},toTitleCase:function(){return vn(this,"toTitleCase")},toCamelCase:function(){return this.list.forEach((function(t){var e=t.terms();e.forEach((function(t,n){0!==n&&t.toTitleCase(),n!==e.length-1&&(t.post="")}))})),this}},gn=F((function(t,e){e.pre=function(t,e){return void 0===t?this.list[0].terms(0).pre:(this.list.forEach((function(n){var r=n.terms(0);!0===e?r.pre+=t:r.pre=t})),this)},e.post=function(t,e){return void 0===t?this.list.map((function(t){var e=t.terms();return e[e.length-1].post})):(this.list.forEach((function(n){var r=n.terms(),i=r[r.length-1];!0===e?i.post+=t:i.post=t})),this)},e.trim=function(){return this.list=this.list.map((function(t){return t.trim()})),this},e.hyphenate=function(){return this.list.forEach((function(t){var e=t.terms();e.forEach((function(t,n){0!==n&&(t.pre=""),e[n+1]&&(t.post="-")}))})),this},e.dehyphenate=function(){var t=/(-|–|—)/;return this.list.forEach((function(e){e.terms().forEach((function(e){t.test(e.post)&&(e.post=" ")}))})),this},e.deHyphenate=e.dehyphenate,e.toQuotations=function(t,e){return t=t||'"',e=e||'"',this.list.forEach((function(n){var r=n.terms();r[0].pre=t+r[0].pre;var i=r[r.length-1];i.post=e+i.post})),this},e.toQuotation=e.toQuotations,e.toParentheses=function(t,e){return t=t||"(",e=e||")",this.list.forEach((function(n){var r=n.terms();r[0].pre=t+r[0].pre;var i=r[r.length-1];i.post=e+i.post})),this}})),bn=(gn.pre,gn.post,gn.trim,gn.hyphenate,gn.dehyphenate,gn.deHyphenate,gn.toQuotations,gn.toQuotation,gn.toParentheses,{join:function(t){this.uncache();for(var e=this.list[0],n=e.length,r={},i=1;i<this.list.length;i++){var o=this.list[i];r[o.start]=!0;var s=e.lastTerm();t&&(s.post+=t),s.next=o.start,o.terms(0).prev=s.id,e.length+=o.length,e.cache={}}var a=e.length-n;return this.parents().forEach((function(t){t.list.forEach((function(t){for(var n=t.terms(),r=0;r<n.length;r++)if(n[r].id===e.start){t.length+=a;break}t.cache={}})),t.list=t.list.filter((function(t){return!0!==r[t.start]}))})),this.buildFrom([e])}}),yn=/[,\)"';:\-–—\.…]/,An=function(t,e){if(t.found){for(var n=t.termList(),r=0;r<n.length-1;r++){var i=n[r];if(yn.test(i.post))return}n.forEach((function(t){t.implicit=t.clean})),n[0].text+=e,n.slice(1).forEach((function(t){t.text=""}));for(var o=0;o<n.length-1;o++){var s=n[o];s.post=s.post.replace(/ /,"")}}},wn={contract:function(){var t=this.not("@hasContraction"),e=t.match("(we|they|you) are");return An(e,"'re"),e=t.match("(he|she|they|it|we|you) will"),An(e,"'ll"),e=t.match("(he|she|they|it|we) is"),An(e,"'s"),e=t.match("#Person is"),An(e,"'s"),e=t.match("#Person would"),An(e,"'d"),e=t.match("(is|was|had|would|should|could|do|does|have|has|can) not"),An(e,"n't"),e=t.match("(i|we|they) have"),An(e,"'ve"),e=t.match("(would|should|could) have"),An(e,"'ve"),e=t.match("i am"),An(e,"'m"),e=t.match("going to"),this}},xn=Object.assign({},De,qe,Me,We,Ue,Ge,Qe,Ze,Je,Ke,tn,rn,an,pn,dn,mn,gn,bn,wn),Pn={};[["terms","."],["hyphenated","@hasHyphen ."],["adjectives","#Adjective"],["hashTags","#HashTag"],["emails","#Email"],["emoji","#Emoji"],["emoticons","#Emoticon"],["atMentions","#AtMention"],["urls","#Url"],["adverbs","#Adverb"],["pronouns","#Pronoun"],["conjunctions","#Conjunction"],["prepositions","#Preposition"]].forEach((function(t){Pn[t[0]]=function(e){var n=this.match(t[1]);return"number"==typeof e&&(n=n.get(e)),n}})),Pn.emojis=Pn.emoji,Pn.atmentions=Pn.atMentions,Pn.words=Pn.terms,Pn.phoneNumbers=function(t){var e=this.splitAfter("@hasComma");return e=e.match("#PhoneNumber+"),"number"==typeof t&&(e=e.get(t)),e},Pn.money=function(t){var e=this.match("#Money #Currency?");return"number"==typeof t&&(e=e.get(t)),e},Pn.places=function(t){var e=this.match("(#City && @hasComma) (#Region|#Country)"),n=this.not(e).splitAfter("@hasComma");return(n=n.concat(e)).sort("index"),n=n.match("#Place+"),"number"==typeof t&&(n=n.get(t)),n},Pn.organizations=function(t){var e=this.clauses();return e=e.match("#Organization+"),"number"==typeof t&&(e=e.get(t)),e},Pn.entities=function(t){var e=this.clauses(),n=e.people();return(n=(n=(n=n.concat(e.places())).concat(e.organizations())).not(["someone","man","woman","mother","brother","sister","father"])).sort("sequence"),"number"==typeof t&&(n=n.get(t)),n},Pn.things=Pn.entities,Pn.topics=Pn.entities;var jn=Pn,En=/^(under|over)-?/,On=function(t,e,n){var r=n.words,i=t[e].reduced+" "+t[e+1].reduced;return void 0!==r[i]&&!0===r.hasOwnProperty(i)?(t[e].tag(r[i],"lexicon-two",n),t[e+1].tag(r[i],"lexicon-two",n),1):e+2<t.length&&void 0!==r[i+=" "+t[e+2].reduced]&&!0===r.hasOwnProperty(i)?(t[e].tag(r[i],"lexicon-three",n),t[e+1].tag(r[i],"lexicon-three",n),t[e+2].tag(r[i],"lexicon-three",n),2):e+3<t.length&&void 0!==r[i+=" "+t[e+3].reduced]&&!0===r.hasOwnProperty(i)?(t[e].tag(r[i],"lexicon-four",n),t[e+1].tag(r[i],"lexicon-four",n),t[e+2].tag(r[i],"lexicon-four",n),t[e+3].tag(r[i],"lexicon-four",n),3):0},Cn=function(t,e){for(var n=e.words,r=e.hasCompound,i=0;i<t.length;i+=1){var o=t[i].clean;if(!0===r[o]&&i+1<t.length){var s=On(t,i,e);if(s>0){i+=s;continue}}if(void 0===n[o]||!0!==n.hasOwnProperty(o))if(o===t[i].reduced||!0!==n.hasOwnProperty(t[i].reduced)){if(!0===En.test(o)){var a=o.replace(En,"");!0===n.hasOwnProperty(a)&&t[i].tag(n[a],"noprefix-lexicon",e)}}else t[i].tag(n[t[i].reduced],"lexicon",e);else t[i].tag(n[o],"lexicon",e)}return t},kn=function(t){var e=t.termList();return Cn(e,t.world),t},Fn=function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),r(n,[{key:"stripPeriods",value:function(){return this.termList().forEach((function(t){!0===t.tags.Abbreviation&&t.next&&(t.post=t.post.replace(/^\./,""));var e=t.text.replace(/\./,"");t.set(e)})),this}},{key:"addPeriods",value:function(){return this.termList().forEach((function(t){t.post=t.post.replace(/^\./,""),t.post="."+t.post})),this}}]),n}(t);return n.prototype.unwrap=n.prototype.stripPeriods,t.prototype.abbreviations=function(t){var e=this.match("#Abbreviation");return"number"==typeof t&&(e=e.get(t)),new n(e.list,this,this.world)},t},Tn=/\./,Nn=function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),r(n,[{key:"stripPeriods",value:function(){return this.termList().forEach((function(t){var e=t.text.replace(/\./g,"");t.set(e)})),this}},{key:"addPeriods",value:function(){return this.termList().forEach((function(t){var e=t.text.replace(/\./g,"");e=e.split("").join("."),!1===Tn.test(t.post)&&(e+="."),t.set(e)})),this}}]),n}(t);return n.prototype.unwrap=n.prototype.stripPeriods,n.prototype.strip=n.prototype.stripPeriods,t.prototype.acronyms=function(t){var e=this.match("#Acronym");return"number"==typeof t&&(e=e.get(t)),new n(e.list,this,this.world)},t},Vn=function(t){return t.prototype.clauses=function(e){var n=this.if("@hasComma").notIf("@hasComma @hasComma").notIf("@hasComma . .? (and|or) .").notIf("(#City && @hasComma) #Country").notIf("(#Date && @hasComma) #Year").notIf("@hasComma (too|also)$").match("@hasComma"),r=this.splitAfter(n),i=r.quotations(),o=(r=r.splitOn(i)).parentheses(),s=(r=r.splitOn(o)).if("#Copula #Adjective #Conjunction (#Pronoun|#Determiner) #Verb").match("#Conjunction"),a=(r=r.splitBefore(s)).if("if .{2,9} then .").match("then"),u=(r=(r=(r=(r=(r=(r=r.splitBefore(a)).splitBefore("as well as .")).splitBefore("such as .")).splitBefore("in addition to .")).splitAfter("@hasSemicolon")).splitAfter("@hasDash")).filter((function(t){return t.wordCount()>5&&t.match("#Verb+").length>=2}));if(u.found){var c=u.splitAfter("#Noun .* #Verb .* #Noun+");r=r.splitOn(c.eq(0))}return"number"==typeof e&&(r=r.get(e)),new t(r.list,this,this.world)},t},$n=function(t){var n=function(t){function n(t,r,i){var s;return e(this,n),(s=a(this,o(n).call(this,t,r,i))).contracted=null,s}return i(n,t),r(n,[{key:"expand",value:function(){return this.list.forEach((function(t){var e=t.terms(),n=e[0].isTitleCase();e.forEach((function(t,n){t.set(t.implicit||t.text),t.implicit=void 0,n<e.length-1&&""===t.post&&(t.post+=" ")})),n&&e[0].toTitleCase()})),this}}]),n}(t);return t.prototype.contractions=function(t){var e=this.match("@hasContraction+");return"number"==typeof t&&(e=e.get(t)),new n(e.list,this,this.world)},t.prototype.expanded=t.prototype.isExpanded,t.prototype.contracted=t.prototype.isContracted,t},Sn=function(t){var n=function(t){var e=t.splitAfter("@hasComma").splitOn("(and|or) not?").not("(and|or) not?"),n=t.match("[.] (and|or)",0);return{things:e,conjunction:t.match("(and|or) not?"),beforeLast:n,hasOxford:n.has("@hasComma")}},s=function(t){function s(){return e(this,s),a(this,o(s).apply(this,arguments))}return i(s,t),r(s,[{key:"conjunctions",value:function(){return this.match("(and|or)")}},{key:"parts",value:function(){return this.splitAfter("@hasComma").splitOn("(and|or) not?")}},{key:"items",value:function(){return n(this).things}},{key:"add",value:function(t){return this.forEach((function(e){var r=n(e).beforeLast;r.append(t),r.termList(0).addPunctuation(",")})),this}},{key:"remove",value:function(t){return this.items().if(t).remove()}},{key:"hasOxfordComma",value:function(){return this.filter((function(t){return n(t).hasOxford}))}},{key:"addOxfordComma",value:function(){var t=this.items(),e=t.eq(t.length-2);return e.found&&!1===e.has("@hasComma")&&e.post(", "),this}},{key:"removeOxfordComma",value:function(){var t=this.items(),e=t.eq(t.length-2);return e.found&&!0===e.has("@hasComma")&&e.post(" "),this}}]),s}(t);return s.prototype.things=s.prototype.items,t.prototype.lists=function(t){var e=this.if("@hasComma+ .? (and|or) not? ."),n=e.match("(#Noun|#Adjective|#Determiner|#Article)+ #Conjunction not? (#Article|#Determiner)? #Adjective? #Noun+").if("#Noun"),r=e.match("(#Adjective|#Adverb)+ #Conjunction not? #Adverb? #Adjective+"),i=e.match("(#Verb|#Adverb)+ #Conjunction not? #Adverb? #Verb+"),o=n.concat(r);return o=(o=o.concat(i)).if("@hasComma"),"number"==typeof t&&(o=e.get(t)),new s(o.list,this,this.world)},t},Bn=function(t){return!0===t.has("#Plural")||!0!==t.has("(#Pronoun|#Place|#Value|#Person|#Uncountable|#Month|#WeekDay|#Holiday|#Possessive)")},In={hour:"an",heir:"an",heirloom:"an",honest:"an",honour:"an",honor:"an",uber:"an"},Dn={a:!0,e:!0,f:!0,h:!0,i:!0,l:!0,m:!0,n:!0,o:!0,r:!0,s:!0,x:!0},qn=[/^onc?e/i,/^u[bcfhjkqrstn][aeiou]/i,/^eul/i],Ln=function(t){if(t.has("#Person")||t.has("#Place"))return"";if(t.has("#Plural"))return"the";var e=t.text("normal").trim();if(In.hasOwnProperty(e))return In[e];var n=e.substr(0,1);if(t.has("^@isAcronym")&&Dn.hasOwnProperty(n))return"an";for(var r=0;r<qn.length;r++)if(qn[r].test(e))return"a";return/^[aeiou]/i.test(e)?"an":"a"},Mn={isSingular:[/(ax|test)is$/i,/(octop|vir|radi|nucle|fung|cact|stimul)us$/i,/(octop|vir)i$/i,/(rl)f$/i,/(alias|status)$/i,/(bu)s$/i,/(al|ad|at|er|et|ed|ad)o$/i,/(ti)um$/i,/(ti)a$/i,/sis$/i,/(?:(^f)fe|(lr)f)$/i,/hive$/i,/(^aeiouy|qu)y$/i,/(x|ch|ss|sh|z)$/i,/(matr|vert|ind|cort)(ix|ex)$/i,/(m|l)ouse$/i,/(m|l)ice$/i,/(antenn|formul|nebul|vertebr|vit)a$/i,/.sis$/i,/^(?!talis|.*hu)(.*)man$/i],isPlural:[/(antenn|formul|nebul|vertebr|vit)ae$/i,/(octop|vir|radi|nucle|fung|cact|stimul)i$/i,/men$/i,/.tia$/i,/(m|l)ice$/i]},zn=/s$/,Wn=function(t){return!Mn.isSingular.find((function(e){return e.test(t)}))&&(!0===zn.test(t)||(!!Mn.isPlural.find((function(e){return e.test(t)}))||null))},Un={he:"his",she:"hers",they:"theirs",we:"ours",i:"mine",you:"yours",her:"hers",their:"theirs",our:"ours",my:"mine",your:"yours"},_n=function(t){var e=t.text("text").trim();return Un.hasOwnProperty(e)?(t.replaceWith(Un[e],!0),void t.tag("Possessive","toPossessive")):/s$/.test(e)?(e+="'",t.replaceWith(e,!0),void t.tag("Possessive","toPossessive")):(e+="'s",t.replaceWith(e,!0),void t.tag("Possessive","toPossessive"))},Hn=function(t){var e={main:t};if(t.has("#Noun (of|by|for) .")){var n=t.splitAfter("[#Noun+]",0);e.main=n.eq(0),e.post=n.eq(1)}return e},Gn={json:function(t){var e=null;"number"==typeof t&&(e=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var n=[];return this.forEach((function(e){var r=e.json(t)[0];r.article=Ln(e),n.push(r)})),null!==e?n[e]:n},adjectives:function(){var t=this.lookAhead("^(that|who|which)? (was|is|will)? be? #Adverb? #Adjective+");return(t=(t=t.concat(this.lookBehind("#Adjective+ #Adverb?$"))).match("#Adjective")).sort("index")},isPlural:function(){return this.if("#Plural")},hasPlural:function(){return this.filter((function(t){return Bn(t)}))},toPlural:function(t){var e=this,n=this.world.transforms.toPlural;return this.forEach((function(r){if(!r.has("#Plural")&&!1!==Bn(r)){var i=Hn(r).main,o=i.text("reduced");if((i.has("#Singular")||!0!==Wn(o))&&(o=n(o,e.world),i.replace(o).tag("#Plural"),t)){var s=i.lookBefore("(an|a) #Adjective?$").not("#Adjective");!0===s.found&&s.remove()}}})),this},toSingular:function(t){var e=this,n=this.world.transforms.toSingular;return this.forEach((function(r){if(!r.has("^#Singular+$")&&!1!==Bn(r)){var i=Hn(r).main,o=i.text("reduced");if((i.has("#Plural")||!0===Wn(o))&&(o=n(o,e.world),i.replace(o).tag("#Singular"),t)){var s=r,a=r.lookBefore("#Adjective");a.found&&(s=a);var u=Ln(s);s.insertBefore(u)}}})),this},toPossessive:function(){return this.forEach((function(t){_n(t)})),this}},Qn=function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),n}(t);return Object.assign(n.prototype,Gn),t.prototype.nouns=function(t){var e=this.match("(#City && @hasComma) (#Region|#Country)"),r=this.not(e).splitAfter("@hasComma");return r=(r=(r=(r=(r=(r=(r=r.concat(e)).match("#Noun+ (of|by)? the? #Noun+?")).not("#Pronoun")).not("(there|these)")).not("(#Month|#WeekDay)")).not("(my|our|your|their|her|his)")).not("(of|for|by|the)$"),"number"==typeof t&&(r=r.get(t)),new n(r.list,this,this.world)},t},Rn=/\(/,Zn=/\)/,Jn=function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),r(n,[{key:"unwrap",value:function(){return this.list.forEach((function(t){var e=t.terms(0);e.pre=e.pre.replace(Rn,"");var n=t.lastTerm();n.post=n.post.replace(Zn,"")})),this}}]),n}(t);return t.prototype.parentheses=function(t){var e=[];return this.list.forEach((function(t){for(var n=t.terms(),r=0;r<n.length;r+=1){var i=n[r];if(Rn.test(i.pre))for(var o=r;o<n.length;o+=1)if(Zn.test(n[o].post)){var s=o-r+1;e.push(t.buildFrom(i.id,s)),r=o;break}}})),"number"==typeof t?(e=e[t]?[e[t]]:[],new n(e,this,this.world)):new n(e,this,this.world)},t},Yn=function(t){var n=function(t){function n(t,r,i){var s;return e(this,n),(s=a(this,o(n).call(this,t,r,i))).contracted=null,s}return i(n,t),r(n,[{key:"strip",value:function(){return this.list.forEach((function(t){t.terms().forEach((function(t){var e=t.text.replace(/'s$/,"");t.set(e||t.text)}))})),this}}]),n}(t);return t.prototype.possessives=function(t){var e=this.match("#Noun+? #Possessive");return"number"==typeof t&&(e=e.get(t)),new n(e.list,this,this.world)},t},Kn={'"':'"',"＂":"＂","'":"'","“":"”","‘":"’","‟":"”","‛":"’","„":"”","⹂":"”","‚":"’","«":"»","‹":"›","‵":"′","‶":"″","‷":"‴","〝":"〞","`":"´","〟":"〞"},Xn=RegExp("("+Object.keys(Kn).join("|")+")"),tr=function(t,e){var n=t.verb,r=n.text("normal");if(n.has("#Infinitive"))return r;var i=null;return n.has("#PastTense")?i="PastTense":n.has("#Gerund")?i="Gerund":n.has("#PresentTense")?i="PresentTense":n.has("#Participle")?i="Participle":n.has("#Actor")&&(i="Actor"),e.transforms.toInfinitive(r,e,i)},er=function(t){var e=t.verb;if(e.has("(are|were|does)")||t.auxiliary.has("(are|were|does)"))return!0;if(e.has("(is|am|do|was)")||t.auxiliary.has("(is|am|do|was)"))return!1;var n=function(t){return t.lookBehind("#Noun+").last()}(e);return!!n.has("(we|they|you)")||(!!n.has("#Plural")||!n.has("#Singular")&&null)},nr=function(t,e){var n=t.verb;if(!t.negative.found)if(t.auxiliary.found)t.auxiliary.eq(0).append("not");else if(n.has("(#Copula|will|has|had|do)"))n.append("not");else{if(n.has("#PastTense")){var r=tr(t,e);return n.replaceWith(r,!0),void n.prepend("did not")}if(n.has("#PresentTense")){var i=tr(t,e);return n.replaceWith(i,!0),void(er(t)?n.prepend("do not"):n.prepend("does not"))}if(n.has("#Gerund")){var o=tr(t,e);return n.replaceWith(o,!0),void n.prepend("not")}er(t)?n.prepend("does not"):n.prepend("do not")}},rr=function(t){var e={adverb:t.match("#Adverb+"),negative:t.match("#Negative"),auxiliary:t.match("#Auxiliary").not("(#Negative|#Adverb)"),particle:t.match("#Particle"),verb:t.match("#Verb").not("(#Adverb|#Negative|#Auxiliary|#Particle)")};if(!e.verb.found)return Object.keys(e).forEach((function(t){e[t]=e[t].not(".")})),e.verb=t,e;if(e.adverb&&e.adverb.found){var n=e.adverb.text("reduced")+"$";t.has(n)&&(e.adverbAfter=!0)}return e},ir=function(t){var e=!1,n=er(t),r=t.negative.found;t.verb.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(e=!0);var i={PastTense:"was",PresentTense:"is",FutureTense:"will be",Infinitive:"is",Gerund:"being",Actor:"",PerfectTense:"been",Pluperfect:"been"};return!0===e&&(i.PresentTense="am",i.Infinitive="am"),n&&(i.PastTense="were",i.PresentTense="are",i.Infinitive="are"),r&&(i.PastTense+=" not",i.PresentTense+=" not",i.FutureTense="will not be",i.Infinitive+=" not",i.PerfectTense="not "+i.PerfectTense,i.Pluperfect="not "+i.Pluperfect,i.Gerund="not "+i.Gerund),i},or=function(t,e){var n=t.verb;if(n.has("#Copula")||"be"===n.out("normal")&&t.auxiliary.has("will"))return ir(t);var r=t.verb.termList(0).hasHyphen(),i=tr(t,e);if(!i)return{};var o=e.transforms.conjugate(i,e);if(o.Infinitive=i,t.particle.found){var s=t.particle.text(),a=!0===r?"-":" ";Object.keys(o).forEach((function(t){return o[t]+=a+s}))}if(t.adverb.found){var u=t.adverb.text(),c=!0===r?"-":" ";!0===t.adverbAfter?Object.keys(o).forEach((function(t){return o[t]+=c+u})):Object.keys(o).forEach((function(t){return o[t]=u+c+o[t]}))}var h=t.negative.found;return h&&(o.PastTense="did not "+o.Infinitive,o.PresentTense="does not "+o.Infinitive,o.Gerund="not "+o.Gerund),o.FutureTense||(o.FutureTense=h?"will not "+o.Infinitive:"will "+o.Infinitive),h&&(o.Infinitive="not "+o.Infinitive),o},sr={json:function(t){var e=this,n=null;"number"==typeof t&&(n=t,t=null),t=t||{text:!0,normal:!0,trim:!0,terms:!0};var r=[];return this.forEach((function(n){var i=n.json(t)[0],o=rr(n);i.parts={},Object.keys(o).forEach((function(t){o[t]&&"Doc"===o[t].isA?i.parts[t]=o[t].text("normal"):i.parts[t]=o[t]})),i.isNegative=n.has("#Negative"),i.conjugations=or(o,e.world),r.push(i)})),null!==n?r[n]:r},adverbs:function(){var t=[];this.forEach((function(e){var n=rr(e).adverb;n.found&&(t=t.concat(n.list))}));var e=this.lookBehind("#Adverb+$");return e.found&&(t=e.list.concat(t)),(e=this.lookAhead("^#Adverb+")).found&&(t=t.concat(e.list)),this.buildFrom(t)},isPlural:function(){var t=this,e=[];return this.forEach((function(n){var r=rr(n);!0===er(r,t.world)&&e.push(n.list[0])})),this.buildFrom(e)},isSingular:function(){var t=this,e=[];return this.forEach((function(n){var r=rr(n);!1===er(r,t.world)&&e.push(n.list[0])})),this.buildFrom(e)},conjugate:function(){var t=this,e=[];return this.forEach((function(n){var r=rr(n),i=or(r,t.world);e.push(i)})),e},toPastTense:function(){var t=this;return this.forEach((function(e){var n=rr(e),r=or(n,t.world).PastTense;r&&e.replaceWith(r,!1)})),this},toPresentTense:function(){var t=this;return this.forEach((function(e){var n=rr(e),r=or(n,t.world),i=r.PresentTense;e.lookBehind("(i|we) (#Adverb|#Verb)?$").found&&(i=r.Infinitive),i&&(e.replaceWith(i,!1),e.tag("PresentTense"))})),this},toFutureTense:function(){var t=this;return this.forEach((function(e){var n=rr(e),r=or(n,t.world).FutureTense;r&&(e.replaceWith(r,!1),e.tag("FutureTense"))})),this},toInfinitive:function(){var t=this;return this.forEach((function(e){var n=rr(e),r=or(n,t.world).Infinitive;r&&(e.replaceWith(r,!1),e.tag("Infinitive"))})),this},toGerund:function(){var t=this;return this.forEach((function(e){var n=rr(e),r=or(n,t.world).Gerund;r&&(e.replaceWith(r,!1),e.tag("Gerund"))})),this},isNegative:function(){return this.if("#Negative")},isPositive:function(){return this.ifNo("#Negative")},toNegative:function(){var t=this;return this.list.forEach((function(e){var n=t.buildFrom([e]),r=rr(n);nr(r,n.world)})),this},toPositive:function(){var t=this.match("do not #Verb");return t.found&&t.remove("do not"),this.remove("#Negative")}},ar=[Fn,Nn,Vn,$n,Sn,Qn,Jn,Yn,function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),r(n,[{key:"unwrap",value:function(){return this}}]),n}(t);return t.prototype.quotations=function(t){var e=[];return this.list.forEach((function(t){for(var n=t.terms(),r=0;r<n.length;r+=1){var i=n[r];if(Xn.test(i.pre))for(var o=(i.pre.match(Xn)||[])[0],s=Kn[o],a=r;a<n.length;a+=1)if(-1!==n[a].post.indexOf(s)){var u=a-r+1;e.push(t.buildFrom(i.id,u)),r=a;break}}})),"number"==typeof t?(e=e[t]?[e[t]]:[],new n(e,this,this.world)):new n(e,this,this.world)},t.prototype.quotes=t.prototype.quotations,t},function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),n}(t);return Object.assign(n.prototype,sr),n.prototype.negate=n.prototype.toNegative,t.prototype.verbs=function(t){var e=this.match("(#Adverb|#Auxiliary|#Verb|#Negative|#Particle)+"),r=(e=(e=e.not("^#Adverb+")).not("#Adverb+$")).match("(#Adverb && @hasComma) #Adverb"),i=e.not(r).splitAfter("@hasComma");return(i=i.concat(r)).sort("index"),(i=i.if("#Verb")).has("(is|was)$")&&(i=i.splitBefore("(is|was)$")),"number"==typeof t&&(i=i.get(t)),new n(i.list,this,this.world)},t},function(t){var n=function(t){function n(){return e(this,n),a(this,o(n).apply(this,arguments))}return i(n,t),n}(t);return t.prototype.people=function(t){var e=this.splitAfter("@hasComma");return e=e.match("#Person+"),"number"==typeof t&&(e=e.get(t)),new n(e.list,this,this.world)},t}],ur=function(t){return Object.keys(jn).forEach((function(e){return t.prototype[e]=jn[e]})),ar.forEach((function(e){return e(t)})),t},cr={misc:xn,selections:jn},hr=function(){function t(n,r,i){var o=this;e(this,t),this.list=n,Object.defineProperty(this,"from",{enumerable:!1,value:r,writable:!0}),void 0===i&&void 0!==r&&(i=r.world),Object.defineProperty(this,"world",{enumerable:!1,value:i,writable:!0}),Object.defineProperty(this,"_cache",{enumerable:!1,writable:!0,value:{}}),Object.defineProperty(this,"found",{get:function(){return o.list.length>0}}),Object.defineProperty(this,"length",{get:function(){return o.list.length}}),Object.defineProperty(this,"isA",{get:function(){return"Doc"}})}return r(t,[{key:"tagger",value:function(){return kn(this)}},{key:"pool",value:function(){return this.list.length>0?this.list[0].pool:this.all().list[0].pool}}]),t}();hr.prototype.buildFrom=function(t){return t=t.map((function(t){return t.clone(!0)})),new hr(t,this,this.world)},hr.prototype.fromText=function(t){var e=ce(t,this.world,this.pool());return this.buildFrom(e)},Object.assign(hr.prototype,cr.misc),Object.assign(hr.prototype,cr.selections),ur(hr);var lr={untag:"unTag",and:"match",notIf:"ifNo",only:"if",onlyIf:"if"};Object.keys(lr).forEach((function(t){return hr.prototype[t]=hr.prototype[lr[t]]}));var fr=hr;return function t(e){var n=e,r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;e&&n.addWords(e);var r=ce(t,n),i=new fr(r,null,n);return i.tagger(),i};return r.tokenize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,r=n;e&&((r=r.clone()).words={},r.addWords(e));var i=ce(t,r),o=new fr(i,null,r);return e&&kn(o),o},r.extend=function(t){return t(fr,n,this,zt,it,Ut),this},r.fromJSON=function(t){var e=he(t,n);return new fr(e,null,n)},r.clone=function(){return t(n.clone())},r.verbose=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.verbose(t),this},r.world=function(){return n},r.version="13.3.2-patched",r.import=r.load,r}(new Ie)}));
